<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>effective_js</title>
<!-- 2016-10-09 Sun 01:50 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="your name" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>

         <link href="http://fonts.googleapis.com/css?family=Droid+Sans+Mono|Galdeano|Open+Sans:600italic,400,600|Roboto+Condensed:400,700" rel="stylesheet" type="text/css">
         <link rel="stylesheet" type="text/css" href="/static/css/main.css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="http://harrifeng.github.io/sitemap.html"> UP </a>
 |
 <a accesskey="H" href="http://harrifeng.github.io/index.html"> HOME </a>
</div><div id="preamble" class="status">

         <div id="header">
            <div id="header-top">
                <div id="blog-title">Harrifeng's Path</div>
                <div id="blog-sub-title">çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…,ç»çŸ¥æ­¤äº‹è¦Coding</div>
            </div>
            <div id="nav">
                <ul>
                    <li><a href="/">é¦–é¡µ</a></li>
                    <li><a href="/about.html">About Me</a></li>
                    <li>
                    </li>
                </ul>
            </div>
         </div>
</div>
<div id="content">
<h1 class="title">effective_js</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Chapter 1: Accustoming Yourself to JavaScript</a>
<ul>
<li><a href="#sec-1-1">Item 01: Know Which JavaScript You are Using</a></li>
<li><a href="#sec-1-2">Item 02: Understand JavaScript's Floating-Point Numbers</a></li>
<li><a href="#sec-1-3">Item 03: Beware of Implicit Coercions</a></li>
<li><a href="#sec-1-4">Item 04: Prefer Primitives to Object Wrappers</a></li>
<li><a href="#sec-1-5">Item 05: Avoid using == with Mixed Types</a></li>
<li><a href="#sec-1-6">Item 06: Learn the Limits of Semicolon Insertion</a></li>
<li><a href="#sec-1-7">Item 07: Think of Strings As Sequences of 16-Bit Code Units</a></li>
</ul>
</li>
<li><a href="#sec-2">Chapter 2: Variable Scope</a>
<ul>
<li><a href="#sec-2-1">Item 08: Minimize Use of the Global Object</a></li>
<li><a href="#sec-2-2">Item 09: Always Declare Local Variable</a></li>
<li><a href="#sec-2-3">Item 10: Avoid with</a></li>
<li><a href="#sec-2-4">Item 11: Get Comfortable with Closures</a></li>
<li><a href="#sec-2-5">Item 12: Understand Variable Hoisting</a></li>
<li><a href="#sec-2-6">Item 13: Use Immediately Invoked Function Expressions to Create Local Scopes</a></li>
<li><a href="#sec-2-7">Item 14: Beware of Unportable Scoping of Named Function Expresions</a></li>
<li><a href="#sec-2-8">Item 15: Beware of Unportable Scoping of Block-Local Function Declarations</a></li>
<li><a href="#sec-2-9">Item 16: Avaoid Creating Local Variables with eval</a></li>
<li><a href="#sec-2-10">Item 17: Prefer Indirect eval to Direct eval</a></li>
</ul>
</li>
<li><a href="#sec-3">Chapter 3: Working with Functions</a>
<ul>
<li><a href="#sec-3-1">Item 18: Understand the Difference between Function, Method, and COnstructor Cells</a></li>
<li><a href="#sec-3-2">Item 19: Get Comfortable Using Higher-Order Functions</a></li>
<li><a href="#sec-3-3">Item 20: Use call to Call Methods with a Custom Receiver</a></li>
<li><a href="#sec-3-4">Item 21: Use apply to Call Functions with Different Numbers of Arguments</a></li>
<li><a href="#sec-3-5">Item 22: Use arguments to Create Variadic Functions</a></li>
<li><a href="#sec-3-6">Item 23: Never Modify the arguments Object</a></li>
<li><a href="#sec-3-7">Item 24: Use a Variable to Save a Reference to arguments</a></li>
<li><a href="#sec-3-8">Item 25: Use bind to Extract Methods with a Fixed Receiver</a></li>
<li><a href="#sec-3-9">Item 26: Use bind to Curry Functions</a></li>
<li><a href="#sec-3-10">Item 27: Prefer Closures to Strings for Encapsulating Code</a></li>
<li><a href="#sec-3-11">Item 28: Avoid Relyingon the toString Method of Functions</a></li>
<li><a href="#sec-3-12">Item 29: Avoid Nonstandard StackInspection Properties</a></li>
</ul>
</li>
<li><a href="#sec-4">Chapter 4: Objects and Prototypes</a>
<ul>
<li><a href="#sec-4-1">Item 30: Understand the difference between prototype, getPrototypeOf, and __proto__</a></li>
<li><a href="#sec-4-2">Item 31: Prefer Object.getPrototypeOf to __proto__</a></li>
<li><a href="#sec-4-3">Item 32: Never Modify __proto__</a></li>
<li><a href="#sec-4-4">Item 33: Make Your Constructors new-Agnostic</a></li>
<li><a href="#sec-4-5">Item 34: Store Methods on Prototypes</a></li>
<li><a href="#sec-4-6">Item 35: Use Closure to Store Private Data</a></li>
<li><a href="#sec-4-7">Item 36: Store Instance State only on Instance Objects</a></li>
<li><a href="#sec-4-8">Item 37: Recognize the Implicit Binding of this</a></li>
<li><a href="#sec-4-9">Item 38: Call Superclass Constructors from Subclass Constructors</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Chapter 1: Accustoming Yourself to JavaScript</h2>
<div class="outline-text-2" id="text-1">
<ul class="org-ul">
<li>jsè®¾è®¡çš„åˆè¡·æ˜¯è®©äººçœ‹èµ·æ¥ç†Ÿæ‚‰,å®ƒæœ‰å¾ˆå¤šscriptè¯­è¨€ä»¥åŠjavaçš„å½±å­
</li>
</ul>
</div>
<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">Item 01: Know Which JavaScript You are Using</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>jsæœ€å¼€å§‹æ˜¯ä½œä¸ºjavaåœ¨webç¼–ç¨‹é¢†åŸŸçš„è¡¥å……è€Œå¼€å‘çš„
</li>
<li>jsçš„æµè¡Œé€ æˆäº†ç¬¬ä¸€æ¬¡çš„æ ‡å‡†åŒ–è¡ŒåŠ¨1997å¹´,è¯ç”Ÿäº†ECMAScript
</li>
<li>ç¬¬ä¸‰ä¸ªç‰ˆæœ¬çš„ECMAScript(ä¹Ÿå°±æ˜¯ES3,å®Œæˆäº1999å¹´)æ˜¯å½“ä»Šä¸–ç•Œæœ€ä¸ºæµè¡Œçš„jsæ ‡å‡†åŒ–
çš„ç‰ˆæœ¬
</li>
<li>2005å¹´å¼•å…¥çš„ES5ä¹Ÿæ˜¯éå¸¸çš„é‡è¦,å®ƒå¼•å…¥äº†å¾ˆå¤šæ–°feature,åŒæ—¶æŠŠä¸€äº›å¹¿æ³›ä½¿ç”¨çš„é
æ ‡å‡†åŒ–çš„featureç»™æ ‡å‡†åŒ–äº†
</li>
<li>åœ¨jsçš„ä¸–ç•Œé‡Œé¢,é™¤äº†æ ‡å‡†åŒ–,è¿˜æœ‰å¾ˆå¤šçš„éæ ‡å‡†åŒ–,æ¯”å¦‚:
<ul class="org-ul">
<li>æœ‰äº›æµè§ˆå™¨æ”¯æŒconst
<div class="org-src-container">

<pre class="src src-js">const PI = 3.1415926;
PI = "modified";
PI; //3.1415926
</pre>
</div>
</li>
<li>æœ‰äº›æµè§ˆå™¨ç›´æ¥æŠŠconstå½“åšvar
<div class="org-src-container">

<pre class="src src-js">const PI = 3.1415926;
PI = "modified";
PI; // "modified"
</pre>
</div>
</li>
</ul>
</li>
<li>ES5å¼•å…¥äº†ä¸€ä¸ªæ–°çš„featureå«åšstrict mode,è¿™ä¸ªfeatureå¯ä»¥è®©ä½ é€‰æ‹©ä½¿ç”¨"ä¸¥æ ¼ç‰ˆ
æœ¬"çš„js:ä¹Ÿå°±æ˜¯å»æˆé‚£äº›æœ‰é—®é¢˜çš„,å®¹æ˜“å‡ºé”™çš„featureç‰ˆæœ¬çš„js
</li>
<li>è€Œæ²¡æœ‰å®æ–½strict mode checkçš„æµè§ˆå™¨ä¹Ÿæ˜¯å¯ä»¥æ‰§è¡Œè¿™äº›ä»£ç çš„,å› ä¸ºå¹¶æ²¡æœ‰ä½¿ç”¨æ–°
çš„feature,åªä¸è¿‡æ˜¯ä¸¥æ ¼ä½¿ç”¨"å›ºå®šçš„feature",ä½¿ç”¨æ–¹æ³•æ˜¯:
<ul class="org-ul">
<li>åœ¨ç¨‹åºæœ€å¼€å§‹ä½¿ç”¨å­—ç¬¦ä¸²æ¥å£°æ˜
<div class="org-src-container">

<pre class="src src-js">"use strict";
</pre>
</div>
</li>
<li>æˆ–è€…åœ¨function bodyé‡Œé¢å£°æ˜(åœ¨è¿™ä¸ªfunctionå†…éƒ¨ä½¿ç”¨strict mode)
<div class="org-src-container">

<pre class="src src-js">function f(x) {
    "use strict";
    // ...
}
</pre>
</div>
</li>
</ul>
</li>
<li>ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²æ¥ä½œä¸ºstrict modeçš„æ ‡è¯†ç¬¦æ˜¯ä¸ºäº†å‘å‰å…¼å®¹,å› ä¸ºES3ä¸çŸ¥é“strict
modeçš„å­˜åœ¨,æ‰€ä»¥å®ƒçœ‹åˆ°è¿™ä¸ªå­—ç¬¦ä¸²evaluateå®ƒçš„å€¼ä¸€ä¸‹,ç„¶åé©¬ä¸Šå°±ä¸¢å¼ƒäº†,ä¸ä¼šäº§ç”Ÿ
ä»»ä½•è´Ÿé¢çš„å½±å“
</li>
<li>å½“ç„¶äº†,ä½ çš„strict modeä¸€å®šè¦åœ¨æ”¯æŒES5çš„æµè§ˆå™¨é‡Œé¢æµ‹è¯•ä¸€ä¸‹,åªåœ¨ES3çš„æµè§ˆå™¨ä¸‹
æ€ä¹ˆå†™éƒ½æ˜¯å¯¹çš„&#x2013;å› ä¸ºES3çš„æµè§ˆå™¨å°±å‹æ ¹ä¸ä¼šå»æµ‹è¯•strict modeå•Š
</li>
<li>strict modeçš„ä¸€ä¸ªå‘æºè‡ªäºå®ƒçš„è¦æ±‚:
<ul class="org-ul">
<li>è¦ä¹ˆåœ¨æ–‡ä»¶æœ€å¼€å§‹
</li>
<li>è¦ä¹ˆåœ¨functionæœ€å¼€å§‹
</li>
</ul>
</li>
<li>ä½†æ˜¯,jsæœ‰å¯èƒ½æ˜¯å¼€å‘çš„æ—¶å€™å„è‡ªä¸ºæˆ˜,éƒ¨ç½²çš„æ—¶å€™,åˆæˆä¸€ä¸ªå¤§çš„jsæ–‡ä»¶,è¿™ä¸ªæ—¶å€™:
<ul class="org-ul">
<li>åŸæœ¬æ˜¯æ–‡ä»¶ç¬¬ä¸€è¡Œçš„strict mode,å¯èƒ½å·²ç»å˜æˆæ–‡ä»¶ä¸­éƒ¨çš„ä¸€å¥å­—ç¬¦ä¸²äº†.
</li>
<li>åŸæœ¬ç¬¬ä¸€è¡Œä¸æ˜¯strict mode,ä½†æ˜¯å› ä¸º"è·Ÿäº†ä¸€ä¸ªstrict mode"çš„æ–‡ä»¶,ä¹Ÿå˜æˆstrict
modeäº†.
</li>
</ul>
</li>
<li>æ‰€ä»¥æˆ‘ä»¬å¼€å‘çš„æ—¶å€™,è¦å°½é‡é¿å…strictå’Œnonstrictæ–‡ä»¶åˆåœ¨ä¸€èµ·,æœ€æç«¯çš„æƒ…å†µä¸‹,
å¦‚æœæˆ‘ä»¬å¿…é¡»åˆå¹¶æ–‡ä»¶(ä¸ºäº†å‡å°‘æ–‡ä»¶å¤§å°),æˆ‘ä»¬å¯æœ€ç»ˆåˆå¹¶æˆä¸¤ä¸ªæ–‡ä»¶:
<ul class="org-ul">
<li>ä¸€ä¸ªstrict mode
</li>
<li>ä¸€ä¸ªnonstrict mode
</li>
</ul>
</li>
<li>å½“ç„¶è¿˜æœ‰æ¯”è¾ƒå±Œçš„æ–¹æ³•:å°±æ˜¯æŠŠä¸€ä¸ªæ–‡ä»¶æ‰€æœ‰çš„å†…å®¹æ”¾å…¥åˆ°ä¸€ä¸ªfunctioné‡Œé¢å»,è¿™å°±
é¿å…äº†åˆå¹¶æ–‡ä»¶æ—¶å€™çš„é—®é¢˜
<div class="org-src-container">

<pre class="src src-js">(function() {
    //file1.js
    "use strict";
    function f() {
        // ...
    }
    // ...
})();
(function() {
    //file2.js
    // no strict-mode directive
    function f() {
        var arguments = [];
        //...
    }
})();
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">Item 02: Understand JavaScript's Floating-Point Numbers</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>å¾ˆå¤šç¼–ç¨‹è¯­è¨€éƒ½æœ‰å¤šç§çš„numer type,ä½†æ˜¯jsåªæœ‰ä¸€ç§,è¿™ä¸ªå¯ä»¥é€šè¿‡typeå„ç§jsé‡Œé¢
çš„æ•°å­—å¾—å‡ºç»“è®º.
<div class="org-src-container">

<pre class="src src-js">console.log(typeof 17);
console.log(typeof 98.6);
console.log(typeof -2.1);

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// number                                         //
// number                                         //
// number                                         //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>å®é™…ä¸Š,æ‰€æœ‰çš„js numberéƒ½æ˜¯64ä½ç²¾åº¦çš„æµ®ç‚¹æ•°
</li>
<li>ä¸€èˆ¬çš„æ“ä½œç¬¦éƒ½æ˜¯æ­£å¸¸çš„
<div class="org-src-container">

<pre class="src src-js">console.log(0.1 * 1.9);
console.log(-99 + 100);
console.log(21 - 2.3);
console.log(2.5 / 5);
console.log(21 % 8);

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// 0.19                                           //
// 1                                              //
// 18.7                                           //
// 0.5                                            //
// 5                                              //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>ä½†æ˜¯å¯¹äºbitwiseæ“ä½œç¬¦,jså´ä¼šæŠŠæµ®ç‚¹æ•°è½¬æ¢æˆ32-bitçš„æ•´æ•°
<div class="org-src-container">

<pre class="src src-js">console.log(8|1);

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// 9                                              //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>åè¿›åˆ¶æ•°å­—å’ŒäºŒè¿›åˆ¶"å­—ç¬¦ä¸²"ä¹‹é—´çš„è½¬æ¢å¦‚ä¸‹:
<ul class="org-ul">
<li>åè¿›åˆ¶åˆ°äºŒè¿›åˆ¶
<div class="org-src-container">

<pre class="src src-js">(8).toString(2); // "1000"
</pre>
</div>
</li>
<li>äºŒè¿›åˆ¶å­—ç¬¦ä¸²åˆ°åè¿›åˆ¶
<div class="org-src-container">

<pre class="src src-js">parseInt("1001", 2); // 9
</pre>
</div>
</li>
</ul>
</li>
<li>æµ®ç‚¹æ•°çš„è®¡ç®—,æœ‰æ—¶å€™æ˜¯ä¸å‡†ç¡®çš„
<div class="org-src-container">

<pre class="src src-js">console.log(0.1+0.2); // 0.30000000000000004
</pre>
</div>
</li>
<li>æµ®ç‚¹æ•°çš„ä¸å‡†ç¡®æ€§è¿˜åœ¨äº,å®ƒä¸æ»¡è¶³"ç»“åˆæ€§(associative property)",æ‰€è°“ç»“åˆæ€§å°±
æ˜¯æ€»ç¬¦åˆ
<pre class="example">
(x + y) + z = x + (y + z)
</pre>
</li>
<li>ä½†æ˜¯jsé‡Œé¢çš„æµ®ç‚¹æ•°è‚¯å®šå°±ä¸ç¬¦åˆå•¦
<div class="org-src-container">

<pre class="src src-js">console.log((0.1 + 0.2) + 0.3);
console.log(0.1 + (0.2 + 0.3));

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// 0.6000000000000001                             //
// 0.6                                            //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>å¦‚æœjsé‡Œé¢éœ€è¦è®¡ç®—,é‚£ä¹ˆæŠŠæµ®ç‚¹æ•°è½¬æ¢æˆæ•´æ•°å»è®¡ç®—æ˜¯éå¸¸å¥½çš„ä¸€ä¸ªworkaround,å› 
ä¸ºæ•´æ•°ä¸ä¼šæœ‰rounding errors.
<div class="org-src-container">

<pre class="src src-js">(10 + 20) + 30; //60
10 + (20 + 30); //60
</pre>
</div>
</li>
<li>åœ¨jsé‡Œé¢,integeråªæ˜¯doubleçš„ä¸€ä¸ªsubset,è€Œä¸æ˜¯å¦å¤–çš„ä¸€ä¸ªdatatype,jsé‡Œé¢æ‰€æœ‰
çš„æ•°æ®ç±»å‹éƒ½æ˜¯number
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">Item 03: Beware of Implicit Coercions</h3>
<div class="outline-text-3" id="text-1-3">
<ul class="org-ul">
<li>å¯¹äºtype error, jsçš„å®¹å¿æ€§æå¼º,å¾ˆå¤šåˆ«çš„è¯­è¨€ç¼–è¯‘å™¨ä¼šæŠ±æ€¨çš„,jséƒ½èƒ½å¿,æ¯”å¦‚
<div class="org-src-container">

<pre class="src src-js">3 + true; // 4
</pre>
</div>
</li>
<li>å¯¹äºé™æ€è¯­è¨€,ä¸Šé¢è‚¯å®šæ˜¯æŠ¥é”™çš„.å¯¹äºå¤§éƒ¨åˆ†çš„é™æ€è¯­è¨€,ä¸Šé¢ä¹Ÿæ˜¯è‡³å°‘ä¼šthrowä¸€ä¸ª
exception
</li>
<li>å½“ç„¶jsçš„å¿è€æ˜¯æœ‰é™åº¦çš„,å¦‚ä¸‹ä¸¤ä¸ªè¿‡äºæ˜æ˜¾çš„typeé”™è¯¯å®ƒè¿˜æ˜¯ä¼šæŠ±æ€¨çš„
<div class="org-src-container">

<pre class="src src-js">"hello"(1);
null.x;
</pre>
</div>
</li>
<li>å…¶ä»–æƒ…å†µä¸‹,jsä¹‹æ‰€ä»¥æ²¡æœ‰æŠ±æ€¨(æˆ–è€…è¯´é”™çš„ä¸ç¦»è°±),å…¶åŸå› æ˜¯jsä¼šcoerceæŸäº›ç±»å‹åˆ°
å¦å¤–ä¸€ç§ç±»å‹,ä½¿å¾—é”™çš„ä¸ç¦»è°±çš„jsèƒ½å¤Ÿè¿è¡Œä¸‹å», coerceçš„è§„åˆ™æ˜¯:
<ul class="org-ul">
<li>å‡å·,ä¹˜å·,é™¤å·,å–ä½™(å‡ºäº†åŠ å·ä»¥å¤–):éƒ½æ˜¯æŠŠargumentè½¬æ¢æˆnumber
</li>
<li>åŠ å·çš„è¯,åˆåˆ†ä¸¤ç§æƒ…å†µ:
<ol class="org-ol">
<li>å¦‚æœä¸¤è¾¹éƒ½ä¸æ˜¯string,é‚£ä¹ˆè½¬æ¢æˆnumber:
<div class="org-src-container">

<pre class="src src-js">2 + 3 ; //5
</pre>
</div>
</li>
<li>ä¸¤è¾¹æœ‰ä¸€ä¸ªæ˜¯string,é‚£ä¹ˆå°±è½¬æ¢ä¸ºstring:
<div class="org-src-container">

<pre class="src src-js">1 + 2 + "3";     // "33"
1 + "2" + 3;     // "123"
</pre>
</div>
</li>
</ol>
</li>
<li>bitwiseè¿˜æ˜¯ä¼šç»Ÿä¸€è½¬æ¢æˆnubmeræ¥å¤„ç†,åªä¸è¿‡,è¿˜æ˜¯è€æ ·å­,doubleå˜æˆinteger
<div class="org-src-container">

<pre class="src src-js">"8.2" | "1"  //9
</pre>
</div>
</li>
</ul>
</li>
<li>coercionå¹¶ä¸æ˜¯æ€»æ˜¯èƒ½å¤Ÿhide error,æœ‰æ—¶å€™ä¼šæŠŠäº‹æƒ…æå¾—æ›´ç³Ÿç³•:
<ul class="org-ul">
<li>ä¸€ä¸ªnullçš„å˜é‡ä¼šè¢«coerceæˆ0
</li>
<li>ä¸€ä¸ªundefinedçš„å˜é‡ä¼šè¢«coerceæˆä¸€ä¸ªç‰¹æ®Šçš„æµ®ç‚¹æ•°NaN
</li>
</ul>
</li>
<li>æ›´åŠ æ‚²æƒ¨çš„æ˜¯NaNæ˜¯ä¸€ä¸ªç‰¹åˆ«ç‰¹æ®Šçš„æ•°,éå¸¸éš¾ä»¥å¯¹ä»˜,ç”šè‡³æ˜¯æµ‹è¯•ä¸€å˜é‡æ˜¯ä¸æ˜¯NaNæ˜¯
éå¸¸éº»çƒ¦çš„,å› ä¸º:
<ul class="org-ul">
<li>NaNå’Œè‡ªå·±ä¸ç›¸ç­‰
<div class="org-src-container">

<pre class="src src-js">var x = NaN;
console.log(x === NaN);

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// false                                          //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>isNaN(num)å‡½æ•°ä¹Ÿä¸å¯é ,å› ä¸ºå®ƒåªæœ‰åœ¨numæ˜¯numberç±»å‹çš„æ—¶å€™æ‰æœ‰ç”¨,æ‰€ä»¥å¦‚æœnum
ä¸æ˜¯numberçš„æƒ…å†µä¸‹,å®ƒæ€»æ˜¯è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªNaN
<div class="org-src-container">

<pre class="src src-js">isNaN("foo")                    // true
isNaN(undefined)                // true
isNaN({})                       // true
isNaN({ valueOf: "foo" })       // true
</pre>
</div>
</li>
<li>å½“ç„¶äº†NaNä¹Ÿæœ‰å¼±ç‚¹,å®ƒçš„å¼±ç‚¹å°±æ˜¯è‡ªå·±ä¸å’Œè‡ªå·±ç›¸ç­‰,æ‰€ä»¥å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‡½æ•°æ¥è¿›è¡Œ
åˆ¤æ–­NaN
<div class="org-src-container">

<pre class="src src-js">function isReallyNaN(x) {
    return x !== x;
}
</pre>
</div>
</li>
</ul>
</li>
<li>objectä¹Ÿå¯ä»¥è½¬æ¢æˆprimitiveç±»å‹, ä¸€èˆ¬ç”¨åœ¨objectå˜åŒ–æˆstring, æ³¨æ„æ˜¯å› ä¸ºåŠ å·
å·¦è¾¹æ˜¯å­—ç¬¦ä¸²,æ‰€ä»¥å³è¾¹ä¹Ÿè¦è½¬æ¢æˆå­—ç¬¦ä¸². å†…éƒ¨å…¶å®æ˜¯è°ƒç”¨çš„toStringå‡½æ•°
<div class="org-src-container">

<pre class="src src-js">"The Math object:" + Math;      // "the Math object: [object Math]"
"The Json object:" + Json;      // "the Json object: [object Json]"
</pre>
</div>
</li>
<li>objectè¦è½¬æ¢æˆnumber,é‚£ä¹ˆå°±æ˜¯è¦è°ƒç”¨valueOfå‡½æ•°
<div class="org-src-container">

<pre class="src src-js">2 * { valueOf: function() { return 3; } }; // 6
</pre>
</div>
</li>
<li>å¦‚æœä½ è®¤ä¸º"+"å·å·¦å³æœ‰stringå°±ä¼šè°ƒç”¨toString(),é‚£å°±å¤§é”™ç‰¹é”™äº†,å› ä¸ºtoValue()
è¿”å›äº†numberè¿˜å¯ä»¥åœ¨"+"çš„æ—¶å€™è½¬æ¢æˆstring.è€Œä¸”ç»“æœä¹Ÿæ˜¯å¤§å®¶æ²¡æœ‰æƒ³åˆ°çš„
<pre class="example">
       åœ¨toString()å’ŒvalueOf()éƒ½å­˜åœ¨çš„æƒ…å†µä¸‹,ä¼˜å…ˆè°ƒç”¨valueOf()
</pre>
</li>
<li>çŸ¥é“äº†ä¸Šé¢çš„æƒ…æ™¯è®¾å®š,ä¸‹é¢çš„ä»£ç å°±ä¸éš¾ç†è§£äº†
<div class="org-src-container">

<pre class="src src-js">var obj = {
    toString: function() {
        return "[object MyObject]";
    },
    valueOf: function() {
        return 17;
    }
};

console.log("object: " + obj);

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// object: 17                                     //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>å¯è§valueOfå…¶å®æ˜¯ä¸ºnumberç±»å‹çš„objectå‡†å¤‡çš„,å¤§éƒ¨åˆ†æƒ…å†µä¸‹,æˆ‘ä»¬ä¸è¦ä¸ºè‡ªå·±çš„
objectå‡†å¤‡valueOfå‡½æ•°,toStringå‡½æ•°æ˜¯å¤§å¤šæ•°objectéœ€è¦çš„.
</li>
<li>æœ€åä¸€ç§coercionå°±æ˜¯booleanç±»å‹çš„è½¬æ¢.å¦‚æœå˜é‡å’Œif, ||, &amp;&amp;ç­‰ä¸€èµ·åˆä½œçš„è¯,å®ƒ
ä¼šè‡ªåŠ¨ä»ä»»æ„ç±»å‹è½¬æ¢æˆå¸ƒå°”ç±»å‹,è½¬æ¢çš„è§„åˆ™å¾ˆç®€å•:
<ul class="org-ul">
<li>å¦‚ä¸‹å‡ ä¸ªvalueè½¬æ¢æˆfalse:
<div class="org-src-container">

<pre class="src src-js">false, 0, -0, "", NaN, null, undefined
</pre>
</div>
</li>
<li>å‰©ä¸‹çš„valueéƒ½è½¬æ¢æˆtrue
</li>
</ul>
</li>
<li>æ‰€ä»¥0å’Œ""éƒ½ä¼šè¢«è®¤ä¸ºæ˜¯false,å› æ­¤,å¦‚ä¸‹çš„ä»£ç æ˜¯é”™è¯¯çš„,å› ä¸ºæ²¡æœ‰è€ƒè™‘åˆ°0ä¸ºfalseçš„
æƒ…å†µ
<div class="org-src-container">

<pre class="src src-js">function point(x, y) {
    if (!x) {
        x = 320;
    }
    if (!y) {
        y = 240;
    }
    return {
        x: x,
        y: y
    };
}

console.log(point(0,0));

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// { x: 320, y: 240 }                             //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>æ­£ç¡®çš„æ–¹æ³•æ˜¯ä½¿ç”¨typeof
<div class="org-src-container">

<pre class="src src-js">function point(x, y) {
    if (typeof x === "undefined") {
        x = 320;
    }
    if (typeof y === "undefined") {
        y = 240;
    }
    return {
        x: x,
        y: y
    };
}

console.log(point());
console.log(point(0, 0));

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// { x: 320, y: 240 }                             //
// { x: 0, y: 0 }                                 //
////////////////////////////////////////////////////
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4">Item 04: Prefer Primitives to Object Wrappers</h3>
<div class="outline-text-3" id="text-1-4">
<ul class="org-ul">
<li>jsä¸­objectæ˜¯ä¸€ä¸ª"å¤æ‚"çš„ç±»å‹, è€Œé™¤äº†objectä»¥å¤–,jsè¿˜æœ‰äº”ç§primitiveç±»å‹:
<ul class="org-ul">
<li>boolean
</li>
<li>number
</li>
<li>string
</li>
<li>null: éå¸¸ä»¤äººè´¹è§£çš„æ˜¯typeof nullçš„ç»“æœæ˜¯object
<div class="org-src-container">

<pre class="src src-js">console.log(typeof null);

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// object                                         //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>undefined
</li>
</ul>
</li>
<li>å°±åƒJavaé‡Œé¢çš„Boxingä¸€æ ·,jsä¹Ÿæœ‰Objectç±»å‹çš„String, Boolean, Number,ä»¥String
ä¸ºä¾‹, objectç±»å‹çš„Stringå’Œstringç±»å‹æœ‰ä¸å°‘ç±»å‹çš„åœ°æ–¹
<div class="org-src-container">

<pre class="src src-js">var s = new String("hello");
console.log(s + " world");
console.log(s[4]);
console.log(typeof s);
console.log(typeof "hello");

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// hello world                                    //
// o                                              //
// object                                         //
// string                                         //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>ä½†å°±æ˜¯typeofä¸ç›¸åŒè¿™ä¸€æ ·,å°±ä¼šå¯¼è‡´ä¸€äº›å’Œprimitive stringä¸ä¸€æ ·çš„è¡Œä¸º,æ¯”å¦‚è™½ç„¶
ä¸¤ä¸ªString objectéƒ½æ˜¯"hello",ä½†å¹¶ä¸ç›¸ç­‰(objectåªå’Œè‡ªå·±ç›¸ç­‰)
<div class="org-src-container">

<pre class="src src-js">var s1 = new String("hello");
var s2 = new String("hello");

s1 === s2;                      // false
s1 == s2;                       // false
</pre>
</div>
</li>
<li>æ­£æ˜¯å› ä¸ºä¸ç›¸ç­‰è¿™ä¸ªç°è±¡,æ‰€ä»¥String objectå…¶å®æ²¡å•¥ç”¨,ä¹‹æ‰€ä»¥åˆ›å»ºåŠå‡ºæ¥,æ˜¯å› ä¸º
primitiveç±»å‹ä¸èƒ½æœ‰è‡ªå·±çš„å‡½æ•°,è€ŒString objectå› ä¸ºæ˜¯object,é‚£è‚¯å®šå¯ä»¥æœ‰è‡ªå·±
çš„å‡½æ•°.
<ul class="org-ul">
<li>primitiveä¸èƒ½æœ‰è‡ªå·±çš„å‡½æ•°, ä½†æ˜¯setå’Œget propertyçš„æ—¶å€™ä¼šåˆ›å»ºä¸´æ—¶çš„boxing
ç±»å‹,è¿™é‡Œå°±æ˜¯String object.å› ä¸ºä¸‹é¢ä¸¤ä¸ªè¯­å¥å…¶å®æ˜¯ä¸¤ä¸ªä¸åŒçš„Object,æ‰€ä»¥ç¬¬äºŒ
å¥ä¸ä¼šæœ‰ç»“æœ
<div class="org-src-container">

<pre class="src src-js">"hello".somProperty = 17;
"hello".somProperty;            // undefined
</pre>
</div>
</li>
<li>primitiveå¯ä»¥è°ƒç”¨toUpperCase()å…¶å®æ˜¯å…ˆç”Ÿæˆä¸€ä¸ªString Object, ç„¶åè°ƒç”¨String
objectçš„å‡½æ•°toUpperCase()
<div class="org-src-container">

<pre class="src src-js">"hello".toUpperCase();          // "HELLO"
</pre>
</div>
</li>
</ul>
</li>
<li>æ‰€ä»¥primitiveä¸èƒ½æœ‰å‡½æ•°,ä½†æ˜¯å› ä¸ºç›¸åº”çš„"Box"ç±»å‹å¯èƒ½ä¸ºä»–æä¾›äº†æŸäº›å‡½æ•°,æ‰€ä»¥
primivite.func()ä¹Ÿæ˜¯ä¸ä¼šæŠ¥é”™çš„.è¿™åŒæ—¶ä¹Ÿéšè—äº†é”™è¯¯,å¦‚æœä½ ä½¿ç”¨äº†var.func(),ä½ 
ä»¥ä¸ºvaræ˜¯object,å…¶å®æ˜¯primitive,é‚£ä¹ˆå…¶å®var.func()æ˜¯ä¸ä¼šæŠ¥é”™çš„.è¿™ç§é”™è¯¯éå¸¸
éšè”½,è¦å°å¿ƒ
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5">Item 05: Avoid using == with Mixed Types</h3>
<div class="outline-text-3" id="text-1-5">
<ul class="org-ul">
<li>jsä¸­æœ‰ä¸¤ä¸ªequal:
<ul class="org-ul">
<li>strict equal (===) å¦‚æœæ¯”è¾ƒçš„ä¸¤ä¸ªæ•°è¿ç±»å‹éƒ½ä¸ä¸€æ ·,å°±ç›´æ¥è¿”å›false
</li>
<li>nonstrict equal(==)å…è®¸æ¯”è¾ƒçš„ä¸¤è€…ç±»å‹ä¸ä¸€æ ·,ä¼šéƒ½è½¬æ¢æˆnumberç±»å‹,ç„¶åå†æ¯”
è¾ƒ,æ‰€ä»¥å¦‚ä¸‹çš„ä¸¤ä¸ªçœ‹èµ·æ¥ä¸ç›¸å¹²çš„å€¼,éƒ½ä¼šè½¬æ¢æˆ1,ä¸€æ¯”è¾ƒ,è¿˜çœŸç›¸ç­‰
<div class="org-src-container">

<pre class="src src-js">"1.0e0" == { valueOf: function() { return true; } }; // true
</pre>
</div>
</li>
</ul>
</li>
<li>æ—¢ç„¶==èƒ½å¤Ÿæ¯”è¾ƒä¸¤ä¸ªç±»å‹ä¸ä¸€æ ·çš„å¯¹è±¡,é‚£ä¹ˆå¾ˆå¤šäººå°±ä¼šé©¬ä¸Šæƒ³åˆ°"åº”ç”¨åœºæ™¯",è€Œä¸”å¯¹
æ­¤éå¸¸æ»¡æ„(featureæ€»ç®—ç”¨ä¸Šäº†)
<div class="org-src-container">

<pre class="src src-js">var today = new Date();

if (form.month.value == (today.getMonth() + 1 &amp;&amp;
                         form.day.value == today.getDate()) {
    // happy birthday!
}
</pre>
</div>
</li>
<li>ä½†æ˜¯è¿™å´å¹¶ä¸æ˜¯æ¨èçš„åšæ³•,ä½¿ç”¨==ç»™è¯»è€…ä¼ é€’çš„ä¿¡å·æ˜¯,==ä¸¤è¾¹çš„ç±»å‹æ˜¯ä¸ä¸€æ ·çš„,ä»–
ä»¬éœ€è¦ä¾é jsçš„coerceåŠŸèƒ½è¿›è¡Œè½¬æ¢,è¿™å°±ç»™äº†jså„ç§å¥‡æ€ªçš„è¯­æ³•ä»¥ç©ºéš™,æ‰€ä»¥æ›´åŠ å¥½
çš„practiceæ˜¯æŠŠä¸¤è€…è½¬åŒ–æˆåŒä¸€ç§ç±»å‹(number),ç„¶åä½¿ç”¨===æ¥æ¯”è¾ƒ
</li>
<li>===ç»™è¯»è€…ä¼ é€’çš„è¯­ä¹‰å°±æ˜¯===å·¦å³ä¸¤è€…ç±»å‹æ˜¯æ˜¯ä¸€æ ·çš„,å‡å°‘äº†è¯»è€…çš„ç„¦è™‘,è€Œunary+
operatorå¯ä»¥æŠŠvalueè½¬æ¢æˆnumberç±»å‹,æ‰€ä»¥æ›´åŠ æ¸…æ™°çš„å†™æ³•å¦‚ä¸‹
<div class="org-src-container">

<pre class="src src-js">var today = new Date();

if (+form.month.value === (today.getMonth() + 1) &amp;&amp;
    +form.day.value === today.getDate()) {
    // happy birthday!
}
</pre>
</div>
</li>
<li>æœ€åæˆ‘ä»¬æ¥æ€»ç»“ä¸‹===å’Œ==çš„è§„åˆ™(æ€»ä½“ä¸Šåªéœ€è¦è®°ä½===è¦æ±‚ç±»å‹ä¸€æ ·,==ä¸è¦æ±‚å°±å¯
ä»¥äº†):
<ul class="org-ul">
<li>å¯¹äº===:
<ol class="org-ol">
<li>å¦‚æœç±»å‹ä¸åŒ,å°±[ä¸ç›¸ç­‰]
</li>
<li>å¦‚æœä¸¤ä¸ªéƒ½æ˜¯numberç±»å‹,å¹¶ä¸”å€¼ä¸€æ ·,é‚£ä¹ˆ[ç›¸ç­‰],ä¾‹å¤–æ˜¯NaNå’ŒNaNä¸ç›¸ç­‰
</li>
<li>å¦‚æœä¸¤ä¸ªéƒ½æ˜¯stringç±»å‹,å¹¶ä¸”æ¯ä¸ªä½ç½®éƒ½ä¸€æ ·,é‚£ä¹ˆ[ç›¸ç­‰]
</li>
<li>å¦‚æœä¸¤ä¸ªéƒ½æ˜¯booleanç±»å‹,å¹¶ä¸”éƒ½æ˜¯trueæˆ–è€…false,é‚£ä¹ˆ[ç›¸ç­‰]
</li>
<li>å¦‚æœä¸¤ä¸ªéƒ½æ˜¯nullç±»å‹,é‚£ä¹ˆ[ç›¸ç­‰]
</li>
<li>å¦‚æœä¸¤ä¸ªéƒ½æ˜¯undefinedç±»å‹,é‚£ä¹ˆ[ç›¸ç­‰]
</li>
<li>å¦‚æœä¸¤ä¸ªéƒ½æ˜¯æŒ‡å‘åŒä¸€ä¸ªobjectæˆ–è€…function,é‚£ä¹ˆ[ç›¸ç­‰]
</li>
</ol>
</li>
<li>å¯¹äº==:
<ol class="org-ol">
<li>å¦‚æœä¸¤ä¸ªç±»å‹ç›¸åŒ,è¿›è¡Œ===æ¯”è¾ƒ
</li>
<li>å¦‚æœä¸€ä¸ªæ˜¯nullç±»å‹,å¦ä¸€ä¸ªæ˜¯undefinedç±»å‹,é‚£ä¹ˆ[ç›¸ç­‰]
</li>
<li>å¦‚æœä¸€ä¸ªæ˜¯stringç±»å‹,ä¸€ä¸ªæ˜¯numberç±»å‹,é‚£ä¹ˆå­—ç¬¦ä¸²å…ˆvalueOf(),ç„¶å===æ¯”è¾ƒ
</li>
<li>å¦‚æœä»»æ„ä¸€ä¸ªæ˜¯booleanç±»å‹,é‚£ä¹ˆå…ˆä¹Ÿæ˜¯valueOf(),trueä¸º1, falseä¸º0
</li>
<li>å¦‚æœä»»æ„ä¸€ä¸ªæ˜¯objectç±»å‹,é‚£ä¹ˆå…ˆè°ƒç”¨valueOf(), ä¸æˆåŠŸå†è°ƒç”¨toString()è½¬
æ¢åå†è¿›è¡Œæ¯”è¾ƒ,ä¾‹å¤–æ˜¯Date,å®ƒå…ˆè°ƒç”¨toString(),ç„¶åè°ƒç”¨valueOf().
</li>
</ol>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-6" class="outline-3">
<h3 id="sec-1-6">Item 06: Learn the Limits of Semicolon Insertion</h3>
<div class="outline-text-3" id="text-1-6">
<ul class="org-ul">
<li>Jsçš„ä¸€ä¸ªæ–¹ä¾¿çš„åœ°æ–¹åœ¨äº,ä½ å¯ä»¥ä¸åœ¨è¡Œå°¾æ·»åŠ åˆ†å·,ç³»ç»Ÿå¯ä»¥è‡ªåŠ¨æ·»åŠ ,è‡ªåŠ¨æ·»åŠ çš„æœº
åˆ¶å«åšautomatic semicolon insertion
<div class="org-src-container">

<pre class="src src-js">function Point(x, y) {
    this.x = x || 0
    this.y = y || 0
}
</pre>
</div>
</li>
<li>ECMAScriptæ ‡å‡†æ˜ç¡®è¡¨ç¤ºäº†åˆ†å·æ’å…¥çš„æœºåˆ¶,æ‰€ä»¥å°‘äº›åˆ†å·æ˜¯ä¸å½±å“ä»£ç çš„portablity
çš„.
</li>
<li>ä½†æ˜¯å°±åƒå‰é¢çš„coercionä¸€æ ·,semicolon insertionæœ‰è‡ªå·±çš„é™·é˜±åœ¨é‡Œé¢,æ‰€ä»¥æˆ‘ä»¬è¦
éå¸¸äº†è§£semicolon insertionçš„æœºåˆ¶,æ‰èƒ½æ­£å¸¸å·¥ä½œ.
</li>
<li>semicolon insertionçš„ç¬¬ä¸€ä¸ªæœºåˆ¶å¦‚ä¸‹:
<pre class="example">
Semicolons are only ever inserted before a } token, after one
or more newlines, or at the end of the program input.
åˆ†å·é€šå¸¸åœ¨}ä¹‹å‰åŠ å…¥åˆ†å·,æˆ–è€…æ¢è¡Œç¬¦ä¹‹å,æˆ–è€…åœ¨program inputä¹‹å
</pre>
</li>
<li>æ‰€ä»¥å¦‚ä¸‹çš„ä»£ç æ˜¯é”™è¯¯çš„,å› ä¸º"+r"åé¢æ—¢æ²¡æœ‰},ä¹Ÿæ²¡æœ‰æ¢è¡Œç¬¦,ä¹Ÿä¸æ˜¯ç¨‹åºçš„ç»“æŸä¹‹å‰
<div class="org-src-container">

<pre class="src src-js">function area(r) { r = +r return Math.PI * r * r}
</pre>
</div>
</li>
<li>semicolon insertionçš„ç¬¬äºŒä¸ªæœºåˆ¶å¦‚ä¸‹:
<pre class="example">
Semicolons are only ever inserted when the next input token
cannot be parsed
åˆ†å·,åªæœ‰å†ä¸‹ä¸€ä¸ªinputæ— æ³•è§£æçš„æ—¶å€™,æ‰ä¼šè‡ªåŠ¨æ’å…¥åˆ†å·
</pre>
</li>
<li>æ¯”å¦‚å¦‚ä¸‹çš„è¿™ä¸ªä¾‹å­
<div class="org-src-container">

<pre class="src src-js">a = b
(f());
</pre>
</div>
</li>
<li>ä¸Šè¿°è¿™ä¸ªä¾‹å­ä¸ä¼šåœ¨båé¢è‡ªåŠ¨æ’å…¥åˆ†å·,å› ä¸ºå¦‚ä¸‹çš„ä»£ç æ˜¯åˆæ³•çš„
<div class="org-src-container">

<pre class="src src-js">a = b(f());
</pre>
</div>
</li>
<li>æ‰€ä»¥,å½“ä¸‹ä¸€è¡Œæ˜¯å¦‚ä¸‹çš„å‡ ç§ç¬¦å·çš„æ—¶å€™,æˆ‘ä»¬è¦ç‰¹åˆ«çš„å°å¿ƒ,å› ä¸ºå¯èƒ½ä¼šè¢«å’Œå½“å‰è¡Œè§£
æåœ¨ä¸€èµ·
<pre class="example">
(, [, +, -, /
</pre>
</li>
<li>çœ‹åˆ°è¿™é‡Œ,è¯»è€…å¯èƒ½ä¼šæƒ³,å¦‚æœæˆ‘ä»æ¥ä¸çœç•¥åˆ†å·,æ˜¯ä¸æ˜¯æœ€åå°±ä¸ä¼šæœ‰é—®é¢˜?ç­”æ¡ˆæ˜¯å¦
å®šçš„:å› ä¸ºåœ¨æŸäº›æƒ…å†µä¸‹jsä¼šå¼ºåˆ¶çš„æ’å…¥åˆ†å·,å³ä¾¿èƒ½å¤Ÿæ­£ç¡®çš„åˆ†æä¸‹ä¸€ä¸ªinput,è¿™ç§
æƒ…å†µå«åšrestricted production
</li>
<li>åœ¨restricted productionä¸­, åœ¨ä¸¤ä¸ªtokenä¹‹é—´æ˜¯ä¸å…è®¸å‡ºç°newlineçš„:
<ul class="org-ul">
<li>æ­£å¸¸ä»£ç ä¸­å¦‚ä¸‹ä»£ç æ˜¯å¯è¡Œçš„,å› ä¸ºjsä¸ä¼šä¸»åŠ¨åœ¨returnåé¢,{å‰é¢åŠ åˆ†å·,å› ä¸ºjs
èƒ½å¤Ÿæ­£å¸¸parseè¿™ä¸ªè¯­å¥
<div class="org-src-container">

<pre class="src src-js">return
{};
</pre>
</div>
</li>
<li>åœ¨restricted productionä¸­,åªè¦å‡ºç°newlineå°±ä¼šåŠ å…¥åˆ†å·(æ¥æ›¿ä»£newline,å› ä¸º
ä¸èƒ½å­˜åœ¨newlineå˜›)
<div class="org-src-container">

<pre class="src src-js">return; {} ;
</pre>
</div>
</li>
</ul>
</li>
<li>å…¶ä»–restricted productionè¿˜æœ‰:
<ul class="org-ul">
<li>A throw statement
</li>
<li>break or continue statement
</li>
<li>postfix ++ or &#x2013; operator
</li>
</ul>
</li>
<li>semicolon insertionçš„ç¬¬ä¸‰ä¸ªæœºåˆ¶æ˜¯:
<pre class="example">
Semicolons are never inserted as separators in the head of a
for loop or as empty statements
forå¾ªç¯é‡Œé¢çš„åˆ†å·ä»æ¥éƒ½ä¸èƒ½çœç•¥, æœ‰empty bodyçš„loopè¦æœ‰æ˜ç¡®çš„åˆ†å·
</pre>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-7" class="outline-3">
<h3 id="sec-1-7">Item 07: Think of Strings As Sequences of 16-Bit Code Units</h3>
<div class="outline-text-3" id="text-1-7">
<ul class="org-ul">
<li>Unicodeçš„æœ¬è´¨éå¸¸å®¹æ˜“ç†è§£:æ¯ä¸€ä¸ªä¸–ç•Œä¸Šå­˜åœ¨çš„å•ä¸ªå­—ç¬¦éƒ½è¢«èµ‹äºˆäº†ä¸€integerå€¼,
è¿™ä¸ªå€¼çš„rangeæ˜¯0~1,114,111è¿™ä¹Ÿè¢«ç§°ä¹‹ä¸ºUnicodeçš„code piont.æ¢å¥è¯è¯´,å…¶å®
Unicodeå°±æ˜¯ä¸€ä¸ªè¶…å¤§å­—ç¬¦é›†çš„ASCII
</li>
<li>è¯´Unicodeæ˜¯ä¸€ä¸ªè¶…å¤§å­—ç¬¦é›†çš„ASCIIæ˜¯æœ‰å…ˆå†³æ¡ä»¶çš„,é‚£å°±æ˜¯è¦ä½¿ç”¨UTF-32çš„encoding
æ ¼å¼.æ‰€è°“UTF-32,æ„æ€å°±æ˜¯æ¯ä¸ªå­—ç¬¦éƒ½ä½¿ç”¨32ä¸ªbitæ¥å­˜å‚¨,Unicodeæœ‰1ç™¾å¤šä¸‡ä¹ˆ,32-bit
å°±æ˜¯40ä¸ªäº¿,æ‰€ä»¥å¯ä»¥è½»æ¾å­˜å‚¨Unicode
</li>
<li>åæ¥äººä»¬å‘ç°ç”¨UTF-32å¤ªæµªè´¹äº†,é‚£å°±ä½¿ç”¨UTF-16, è€ŒUTF-16åªæœ‰6ä¸‡å¤šä¸ªè¡¨ç¤ºæ–¹å¼,æ‰€
ä»¥å°±æœ‰ä¸€ä¸ªæ˜ å°„,æ¯”å¦‚å¦‚æœå°äº6ä¸‡çš„Unicodeå°±ç”¨ä¸€ä¸ªUTF-16è¡¨ç¤º,å¤§äºçš„,å°±ç”¨ä¸¤ä¸ªUTF-15
å­—ç¬¦è¡¨ç¤º
</li>
<li>æ›´åæ¥å¤§å®¶å‘ç°ASCIIå å¤§å¤šæ•°,é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨UTF-8, å¸¸ç”¨çš„ASCIIå°±ä½¿ç”¨ä¸€ä¸ªUTF-8
å…¶ä»–çš„å¯ä»¥ä½¿ç”¨ä¸¤ä¸ª,ä¸‰ä¸ª,æˆ–è€…å››ä¸ªUTF-8å­—ç¬¦.
</li>
<li>é‚£å¾ˆæ˜æ˜¾æœ€çœåŠ²çš„åŠæ³•æ˜¯ä½¿ç”¨UTF-32,ä¸€åŠ³æ°¸é€¸,æ¯ä¸ªå­—ç¬¦éƒ½æœ‰å”¯ä¸€å¯¹åº”çš„integerå€¼,ä½†
æ˜¯å‘çˆ¹çš„æ˜¯åœ¨jsè¯ç”Ÿçš„é‚£ä¸ªæ—¶å€™,Unicodeè¿˜æ˜¯16bitçš„,æ‰€ä»¥UTF-16è‡ªç„¶æ˜¯ä¸€åŠ³æ°¸é€¸çš„.
æ‰€ä»¥å’ŒJavaScriptå’ŒJavaä¸€æ ·é€‰æ‹©äº†UTF-16.æ‰€ä»¥
<pre class="example">
An element of a JavaScript string is a 16-bit code unit
</pre>
</li>
<li>ä¹Ÿå°±æ˜¯è¯´,å¦‚æœæœ‰Unicode integerè¶…è¿‡65535çš„å­—ç¬¦çš„è¯,é‚£ä¹ˆåœ¨JSé‡Œé¢å°±ä¼šä½¿ç”¨ä¸¤ä¸ª
16-bit code unitæ¥è¿›è¡Œå­˜å‚¨
<div class="org-src-container">

<pre class="src src-js">console.log("ğ„loveyou".length);
console.log("Iloveyou".length);

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// 9                                              //
// 8                                              //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>ä¹Ÿå°±æ˜¯è¯´,å¦‚æœjsè¦åº”å¯¹full range of Unicdoe,é‚£ä¹ˆå®ƒçš„å¾ˆå¤šå†…ç½®å‡½æ•°æ¯”å¦‚length,
index, regular expression patternéƒ½ä¸èƒ½ä½¿ç”¨äº†.
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Chapter 2: Variable Scope</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">Item 08: Minimize Use of the Global Object</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li>å…¨å±€å˜é‡æœ‰ç€å¾ˆç‰¹æ®Šçš„ä¸€é¢,å®ƒå¯ä»¥æ¥è§¦æ•´ä¸ªç¨‹åºé‡Œé¢çš„ä»»æ„ä»£ç .ä½†è¿™ç§ä¾¿åˆ©åªå¯¹æ–°æ‰‹
æœ‰è¯±æƒ‘,å¯¹äºæœ‰ç»éªŒçš„ç¨‹åºå‘˜æ¥è¯´,ä»–ä»¬ä¼šå°½é‡é¿å…global variable
</li>
<li>å®šä¹‰å…¨å±€å˜é‡ä¼šæ±¡æŸ“common namespace,ä¼šå¼•å…¥å¯èƒ½çš„name collision
</li>
<li>å…¨å±€å˜é‡è¿˜è¿åäº†æ¨¡å—åŒ–åŸåˆ™,ä»–ä»¬çš„å­˜åœ¨å¯èƒ½ä¼šé€ æˆä¸¤ä¸ªæœ¬æ¥æ¨¡å—åŒ–çš„ä»£ç ä¹‹é—´çš„è”
ç³».
</li>
<li>ä¹Ÿæ­£æ˜¯å› ä¸ºglobal namespaceæ˜¯jsä¸­ä¸åŒcomponentä¹‹é—´è”ç³»çš„å”¯ä¸€çº½å¸¦,æ‰€ä»¥å¾ˆå¤šæ—¶
å€™global namespaceä¹Ÿæ˜¯ä¸å¾—ä¸ä½¿ç”¨çš„.æ¯”å¦‚ä¸€äº›jsçš„åº“,å¿…é¡»å®šä¹‰globalçš„name,æ‰€ä»¥
å…¶ä»–éƒ¨åˆ†çš„jsæ‰èƒ½è°ƒç”¨å®ƒ.
</li>
<li>ä¸€ä¸ªå¸¸è§çš„é”™è¯¯å°±æ˜¯åœ¨å…¨å±€å®šä¹‰temporaryå˜é‡, å¦‚ä¸‹ä¾‹,å¦‚æœæˆ‘ä¹°çš„scoreå‡½æ•°ä¹Ÿä½¿ç”¨
äº†i,n,sumç­‰å˜é‡çš„è¯,é‚£ä¹ˆç¨‹åºå°±ä¼šå‡ºé”™
<div class="org-src-container">

<pre class="src src-js">var i, n, sum;

function averageScore(players) {
    sum = 0;
    for (i = 0, n = players.length; i &lt; n; i++) {
        sum += score(players[i]);
    }
    return sum /n;
}
</pre>
</div>
</li>
<li>è§£å†³åŠæ³•å½“ç„¶æ˜¯è®©ä¸´æ—¶å˜é‡çš„scopeå°½å¯èƒ½çš„å°
<div class="org-src-container">

<pre class="src src-js">function averageScore(players) {
    var i, n, sum;
    sum = 0;
    for (i = 0, n = players.length; i &lt; n; i++) {
        sum += score(players[i]);
    }
    return sum / n;
}
</pre>
</div>
</li>
<li>JSçš„global namespaceä¹Ÿä¼šè¢«å¯¼å‡ºæˆglobal object,åœ¨ç¨‹åºå¼€å§‹çš„æ—¶å€™,ä¼šè¢«ä½œä¸ºthis
çš„åˆå§‹åŒ–å€¼.è¿™ä¸ªæ˜¯éå¸¸ç‰¹æ®Šçš„ç”¨æ³•,éœ€è¦ç‰¹åˆ«æ³¨æ„
<div class="org-src-container">

<pre class="src src-js">var foo = "global foo";
this.foo = "changed";
foo;                            // "changed"
</pre>
</div>
</li>
<li>è€Œä¸”åœ¨æµè§ˆå™¨é‡Œé¢global objectè¿˜å’Œwindow variableè¿›è¡Œäº†ç»‘å®š,ä¹Ÿå°±æ˜¯è¯´,åœ¨æµè§ˆå™¨
çš„globalåŸŸé‡Œé¢,thiså°±ç­‰äºwindow
</li>
<li>æˆ‘ä»¬è™½ç„¶å¯ä»¥ä½¿ç”¨this(æˆ–è€…window).variable = xxxçš„æ–¹å¼æ¥å®šä¹‰å…¨å±€å˜é‡,ä½†æ˜¯ä½¿ç”¨
varæ˜¯æ›´åŠ æ¸…æ™°çš„åšæ³•
</li>
<li>å½“ç„¶äº†this(window)çš„å­˜åœ¨è¿˜æ˜¯å¾ˆæœ‰æ„ä¹‰çš„,å› ä¸ºä¸€ä¸ªlibraryè¦æƒ³å‘æŒ¥ä½œç”¨,å°±è¦åœ¨global
é‡Œé¢å®šä¹‰ä¸€ä¸ªå˜é‡,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥è¯¢this(window)é‡Œé¢æ—¶å€™æœ‰æŸä¸ªå˜é‡æ¥åˆ¤è¯»æŸ
ä¸ªfeatureæ˜¯å¦å·²ç»åº”ç”¨,æ¯”å¦‚æˆ‘ä»¬æµ‹è¯•æµè§ˆå™¨æ˜¯å¦æä¾›äº†ES5çš„JSONåŠŸèƒ½
<div class="org-src-container">

<pre class="src src-js">if (!this.JSON) {
    this.JSON = {
        //parse: ..
    };
}
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">Item 09: Always Declare Local Variable</h3>
<div class="outline-text-3" id="text-2-2">
<ul class="org-ul">
<li>å¦‚æœæœ‰æ¯”global variableæ›´éº»çƒ¦çš„äº‹æƒ…çš„è¯,é‚£å°±å½“å±unintential global variable
äº†.ä½†æ˜¯ç”±äºJSçš„è‡ªèº«ç‰¹ç‚¹,å°±å¾ˆå®¹æ˜“"ä¸€ä¸å°å¿ƒåˆ›å»ºäº†global variable"
</li>
<li>æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­,ç”±äºå¿˜äº†ç»™tempå‰é¢åŠ var,æ‰€ä»¥ç¨‹åºè‡ªåŠ¨åˆ›å»ºäº†ä¸€ä¸ªå…¨å±€å˜é‡temp,
å¹¶ç»™ä»–èµ‹äº†å€¼
<div class="org-src-container">

<pre class="src src-js">function swap(a, i, j) {
    temp = a[i];
    a[i] = a[j];
    a[j] = temp;
}

swap([2, 3], 0, 1);
console.log(temp);

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// 2                                              //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>æ­£ç¡®çš„åšæ³•æ˜¯ä½¿ç”¨var
<div class="org-src-container">

<pre class="src src-js">function swap(a, i, j) {
    var temp = a[i];
    a[i] = a[j];
    a[j] = temp;
}

swap([2, 3], 0, 1);
console.log(typeof temp);

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// undefined                                      //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>æœ‰å¾ˆå¤šlintå·¥å…·å¯ä»¥æ£€æŸ¥è¿™ç§é”™è¯¯,æ¨èä½¿ç”¨lintå·¥å…·è¿›è¡Œæ£€æŸ¥.
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3">Item 10: Avoid with</h3>
<div class="outline-text-3" id="text-2-3">
<ul class="org-ul">
<li>withæ˜¯ä¸ºäº†è®©å¤§å®¶èƒ½å¤Ÿå°‘å†™ä¸€ç‚¹ä»£ç ,è‡ªåŠ¨ç»‘å®šæŸä¸ªobject,ä½†æ˜¯äº‹å®è¯æ˜,è¿™ä¸ªfeature
ç”±äºæ­§ä¹‰å¤ªå¤§,å®Œå…¨ä¸æ¨èä½¿ç”¨!
<div class="org-src-container">

<pre class="src src-js">function status(info) {
    var widget = new Widget();
    with(widget) {
        setBackground("blue");
        setForeground("white");
        setText("Status: " + info); // ambiguous reference because of info
        show();
    }
}
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4">Item 11: Get Comfortable with Closures</h3>
<div class="outline-text-3" id="text-2-4">
<ul class="org-ul">
<li>Closureæ˜¯jsè‡ªå·±å¸¦çš„ä¸€ç§feature,å…¶ä»–è¯­è¨€é‡Œé¢å¹¶æ²¡æœ‰.ç†è§£closureéœ€è¦ç†è§£å¦‚ä¸‹çš„
ä¸‰ä¸ªé‡è¦çš„fact:
<ol class="org-ol">
<li>JSå…è®¸functionå¼•ç”¨é‚£äº›å®šä¹‰åœ¨å½“å‰functionä¹‹å¤–scopeçš„variable, æ¯”å¦‚ä¸‹ä¾‹ä¸­
çš„makeå‡½æ•°,å®ƒè°ƒç”¨äº†ä¸åœ¨å®ƒscopeé‡Œé¢çš„magicIngredient
<div class="org-src-container">

<pre class="src src-js">function makeSandwich() {
    var magicIngredient = "peanut butter";
    function make(filling) {
        return magicIngredient + " and " + filling;
    }
    return make("jelly");
}
console.log(makeSandwich());

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// peanut butter and jelly                        //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>JSå…è®¸functionå¼•ç”¨é‚£äº›å®šä¹‰åœ¨"outer function"é‡Œé¢çš„variable,å³ä¾¿è¿™ä¸ªouter
functionå·²ç»returnedäº†!è¿™ç§æƒ…å†µæè¿°èµ·æ¥æ¯”è¾ƒæ™¦æ¶©,éœ€è¦çœ‹çœ‹ä»£ç ,æ¯”å¦‚ä¸‹ä¾‹ä¸­,
inner functionå°±æ˜¯make, outer functionå°±æ˜¯sandwichMaker, inner function
å¼•ç”¨äº†outer functionä¸­å®šä¹‰çš„å˜é‡magicIngredient, ä½†æ˜¯å³ä¾¿outer function
å·²ç»è¿”å›,æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥å¼•ç”¨åˆ°å®ƒé‡Œé¢çš„å˜é‡
<div class="org-src-container">

<pre class="src src-js">function sandwichMaker() {
    var magicIngredient = "peanut butter";
    function make(filling) {
        return magicIngredient + " and " + filling;
    }
    return make;
}

var f = sandwichMaker();
console.log(f("jelly"));

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// peanut butter and jelly                        //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>ä¸Šè¿°ä¸¤ç§æƒ…å†µå¯ä»¥å®ç°çš„åŸå› å°±æ˜¯closure,å®ƒçš„åŸç†å°±æ˜¯functionä¸€æ—¦å¼•ç”¨äº†æŸä¸ª
å˜é‡.é‚£ä¹ˆå®ƒå°±ä¼šä¸€ç›´ä¿æŒç€å¯¹è¿™ä¸ªå˜é‡çš„reference.è¿™ç§æœºåˆ¶å«åšclosure.æˆ‘ä»¬
ç¬¬ä¸‰ä¸ªfactå°±æ˜¯closureä¿æŒçš„referenceæ˜¯çœŸæ­£çš„ref(è€Œä¸æ˜¯copy),æ‰€ä»¥ä¸€æ—¦å‡½æ•°
å¯¹å…¶refçš„å˜é‡è¿›è¡Œäº†æ›´æ”¹,é‚£ä¹ˆæ‰€æœ‰åŒ…æ‹¬è¿™ä¸ªrefçš„closureéƒ½ä¼šçœ‹åˆ°
<div class="org-src-container">

<pre class="src src-js">function box() {
    var val = undefined;
    return {
        set: function(newVal) { val = newVal; },
        get: function() {return val;},
        type:function() {return typeof val;}
    };
};

var b = box();
console.log(b.type());
b.set(98.6);
console.log(b.get());

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// undefined                                      //
// 98.6                                           //
////////////////////////////////////////////////////
</pre>
</div>
</li>
</ol>
</li>
<li>closureå­˜å‚¨äº†å…¶èƒ½å¤Ÿè®¿é—®çš„å˜é‡çš„ref,é‚£ä¹ˆä¸€ä¸ªfunctionèƒ½å¤Ÿè®¿é—®çš„å˜é‡è‚¯å®šæ˜¯åœ¨å®ƒ
çš„scopeé‡Œé¢.è¿™é‡Œåˆæ¶‰åŠåˆ°ä¸€ä¸ªé—®é¢˜,jsé‡Œé¢çš„scopeæ˜¯å¤šå¤§,ç­”æ¡ˆå¦‚ä¸‹.æ³¨æ„jsé‡Œé¢çš„
scopeæ˜¯å’Œå¤–éƒ¨functionç´§å¯†è”ç³»çš„,è€Œä¸æ˜¯`{}`
<pre class="example">
parameters and variables of outer functions
å¤–éƒ¨å‡½æ•°é‡Œé¢å®šä¹‰çš„å‚æ•°å’Œå˜é‡
</pre>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-5" class="outline-3">
<h3 id="sec-2-5">Item 12: Understand Variable Hoisting</h3>
<div class="outline-text-3" id="text-2-5">
<ul class="org-ul">
<li>JSé‡Œé¢çš„scopeä¸æ˜¯ä»¥blockä¸ºç•Œé™çš„,ä¹Ÿå°±æ˜¯è¯´variable difinitionä¸æ˜¯é™å®šåœ¨æœ€è¿‘
çš„`{}`,è€Œæ˜¯é™å®šåœ¨åŒ…å«å®ƒ(è¿™ä¸ªvariable)çš„functioné‡Œé¢
</li>
<li>å¦‚æœä¸æ˜ç™½ä¸Šè¿°è¿™ä¸ªåŸç†,å°±ä¼šçŠ¯å¦‚ä¸‹çš„é”™è¯¯:ä»¥ä¸ºè‡ªå·±åœ¨foré‡Œé¢å®šä¹‰player,å°±ä¼šæœ‰
ä¸€ä¸ªlocalçš„variable player,ä½†æ˜¯å…¶å®è¿™åªæ˜¯é‡å¤å®šä¹‰äº†å‡½æ•°å‚æ•°é‡Œé¢çš„player
<div class="org-src-container">

<pre class="src src-js">function isWinner(player, otehrs) {
    var highest = 0;
    for (var i = 0, n = others.length; i &lt; n; i++) {
        var player = otehrs[i];
        if (player.score &gt; highest) {
            highest = player.score;
        }
    }
    return player.score &gt; highest;
}
</pre>
</div>
</li>
<li>è¿™ä¸ªçœ‹ä¼¼å¥‡æ€ªçš„"é‡å¤å®šä¹‰"å…¶å®æ˜¯æ²¡äº†è§£jsçš„variable declarationè§„åˆ™,jsçš„å˜é‡å®š
ä¹‰è§„åˆ™å…¶å®åŒ…æ‹¬ä¸¤ä¸ªéƒ¨åˆ†:
<ul class="org-ul">
<li>declaration: jsæš—ä¸­æŠŠæ‰€æœ‰çš„å‡ºç°çš„å˜é‡éƒ½declarationéƒ½æ”¾åœ¨function closure
çš„æœ€ä¸Šé¢
</li>
<li>assignment: varå‡ºç°çš„æ—¶å€™,å…¶å®ä¸æ˜¯å£°æ˜,è€Œæ˜¯assignment,æ¯æ¬¡varå‡ºç°å°±èµ‹å€¼ä¸€
æ¬¡.æ—¢ç„¶varåªä¸è¿‡æ˜¯"èµ‹å€¼",é‚£ä¹ˆvarä¸¤æ¬¡ä¸€æ ·çš„å˜é‡æ˜¯å®Œå…¨æ²¡æœ‰é—®é¢˜çš„
</li>
</ul>
</li>
<li>å”¯ä¸€ä¸€ä¸ªä¸éµå®ˆjsçš„çº¦å®š,ä½¿ç”¨block scopingçš„æ˜¯try&#x2026;catché‡Œé¢æ˜¯catch scope
<div class="org-src-container">

<pre class="src src-js">function test() {
    var x = "var",
        result = [];
    result.push(x);
    try {
        throw "exception";
    } catch (x) {
        x = "catch";
    }
    result.push(x);
    return result;
}

console.log(test());

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// [ 'var', 'var' ]                               //
////////////////////////////////////////////////////
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-6" class="outline-3">
<h3 id="sec-2-6">Item 13: Use Immediately Invoked Function Expressions to Create Local Scopes</h3>
<div class="outline-text-3" id="text-2-6">
<ul class="org-ul">
<li>closureå­˜å‚¨outer functionçš„reference,è€Œä¸æ˜¯value copy,æ‰€ä»¥ä¸‹é¢çš„ä»£ç æ²¡æœ‰èƒ½
å¤Ÿå¾—åˆ°10,è€Œæ˜¯å¾—åˆ°äº†undefined.
<div class="org-src-container">

<pre class="src src-js">function wrapElements(a) {
    var result = [], i, n;
    for (i = 0, n = a.length; i &lt; n; i++) {
        result[i] = function() { return a[i];};
    }
    return result;
}

var wrapped = wrapElements([10, 20, 30, 40, 50]);
var f = wrapped[0];
console.log(f());

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// undefined                                      //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>return a[i]çš„è¿™ä¸ªi,åªèƒ½ä½¿ç”¨a.lengthè¿™ä¸ªå€¼, å› ä¸ºresultçš„æ¯ä¸ªæˆå‘˜éƒ½æ˜¯a[i], è€Œ
iæœ€åéƒ½æ˜¯5,äº†,æ‰€ä»¥è‚¯å®šéƒ½è¿”å›undefined,å¦‚æœæˆ‘ä»¬æœ€åå¼ºåˆ¶çš„æ”¹å˜içš„å€¼ä¸º1çš„è¯,é‚£
ä¹ˆæ‰€æœ‰çš„å€¼æœ€åéƒ½æ˜¯20äº†
<div class="org-src-container">

<pre class="src src-js">function wrapElements(a) {
    var result = [], i, n;
    for (i = 0, n = a.length; i &lt; n; i++) {
        result[i] = function() { return a[i];};
    }
    i = 1;
    return result;
}

var wrapped = wrapElements([10, 20, 30, 40, 50]);
var f = wrapped[0];
console.log(f());
var f2 = wrapped[1];
console.log(f2());

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// 20                                             //
// 20                                             //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>è§£å†³åŠæ³•æ˜¯åˆ›å»ºä¸€ä¸ªnested function,å¹¶ä¸”å¿«é€Ÿè°ƒç”¨å®ƒ,è¿™ä¸ªæŠ€å·§å«åšimmediately
invoked function expression (IIFE)
<div class="org-src-container">

<pre class="src src-js">function wrapElements(a) {
    var result = [];
    for (var i = 0, n = a.length; i &lt; n; i++) {
        (function() {
            var j = i;
            result[i] = function() { return a[j];};
        })();
    }
    return result;
}

var wrapped = wrapElements([10, 20, 30, 40, 50]);
var f = wrapped[0];
console.log(f());

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// 10                                             //
////////////////////////////////////////////////////
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-7" class="outline-3">
<h3 id="sec-2-7">Item 14: Beware of Unportable Scoping of Named Function Expresions</h3>
<div class="outline-text-3" id="text-2-7">
<ul class="org-ul">
<li>TODO
</li>
<li>named function é—®é¢˜å¤ªå¤š,ä¸æ¨èä½¿ç”¨
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-8" class="outline-3">
<h3 id="sec-2-8">Item 15: Beware of Unportable Scoping of Block-Local Function Declarations</h3>
<div class="outline-text-3" id="text-2-8">
<ul class="org-ul">
<li>TODO
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-9" class="outline-3">
<h3 id="sec-2-9">Item 16: Avaoid Creating Local Variables with eval</h3>
<div class="outline-text-3" id="text-2-9">
<ul class="org-ul">
<li>TODO
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-10" class="outline-3">
<h3 id="sec-2-10">Item 17: Prefer Indirect eval to Direct eval</h3>
<div class="outline-text-3" id="text-2-10">
<ul class="org-ul">
<li>TODO
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Chapter 3: Working with Functions</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">Item 18: Understand the Difference between Function, Method, and COnstructor Cells</h3>
<div class="outline-text-3" id="text-3-1">
<ul class="org-ul">
<li>ä»ooè¯­è¨€è¿‡æ¥çš„äºº,è‚¯å®šä¼šæŠŠfunction, method, classå½“åšä¸‰ä¸ªä¸åŒçš„æ¦‚å¿µ,ä½†æ˜¯åœ¨
jsé‡Œé¢,è¿™ä¸ªä¸‰è€…éƒ½æ˜¯å¯¹functionçš„ä¸åŒåº”ç”¨è€Œå·²:
<ul class="org-ul">
<li>æœ€ç®€å•çš„å½“ç„¶å°±æ˜¯function calläº†
<div class="org-src-container">

<pre class="src src-js">function hello(username) {
    return "hello, " + username;
}
hello("Keyser Soze");           // "hello, Keyser Soze"
</pre>
</div>
</li>
<li>åœ¨jsé‡Œé¢,å¦‚æœä¸€ä¸ªobjectçš„æŸä¸ªpropertyæ˜¯ä¸ªfunctionçš„è¯,é‚£ä¹ˆobject.property
çš„ä½¿ç”¨,å°±æ˜¯ä¸€ç§methodå•¦. å’Œfunctionä¸åŒçš„æ˜¯,methodéœ€è¦ä¸€ä¸ªreciver,ä¼šå»è¿™ä¸ª
receiverçš„propertyé‡Œé¢å¯»æ‰¾.
<div class="org-src-container">

<pre class="src src-js">var obj = {
    hello: function() {
        return "hello, " + this.username;
    },
    username: "Hans Gruber"
};

obj.hello();                    // "hello, Hans Gruber"
</pre>
</div>
</li>
<li>jsé‡Œé¢newåé¢è·Ÿçš„ä¸æ˜¯class name,è€Œæ˜¯ä¸€ä¸ªfunction(ä¹Ÿå°±æ˜¯ctor functionä¸€
èˆ¬function nameæ˜¯å¤§å†™çš„)
<div class="org-src-container">

<pre class="src src-js">function User(name, passwordHash) {
    this.name = name;
    this.passwordHash = passwordHash;
}
var u = new User("sfalken",
                 "0ef33a79dawbaweadw");
u.name;                         // "sfalken"
</pre>
</div>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">Item 19: Get Comfortable Using Higher-Order Functions</h3>
<div class="outline-text-3" id="text-3-2">
<ul class="org-ul">
<li>functional è¯­è¨€ç”¨çš„éå¸¸å¤šçš„ä¸¤ç‚¹æ˜¯:
<ul class="org-ul">
<li>æŠŠfunctionå½“åšå‡½æ•°çš„å‚æ•°
</li>
<li>æŠŠfunctionå½“åšå‡½æ•°çš„è¿”å›å€¼
</li>
</ul>
</li>
<li>è¿™ä¸¤ç§æ–¹æ³•èƒ½è®©æˆ‘ä»¬çš„ä»£ç å˜å¾—éå¸¸ç®€æ´å®¹æ˜“ç†è§£,æ¯”å¦‚æ’åº,æˆ‘ä»¬å¯ä»¥æŠŠè§„åˆ™åšæˆä¸€
ä¸ªå‡½æ•°,ç„¶åä¼ å…¥åˆ°sort()å‡½æ•°é‡Œé¢
<div class="org-src-container">

<pre class="src src-js">function compareNumbers(x, y) {
    if (x &lt; y) {
        return -1;
    }
    if (x &gt; y) {
        return 1;
    }
    return 0;
}

[3, 1, 4, 1, 5, 9].sort(compareNumbers); // [1, 1, 3, 4, 5, 9]
</pre>
</div>
</li>
<li>ES5è¿˜å¼•å…¥äº†mapå‡½æ•°,å¯ä»¥å¯¹ä¸€ä¸ªæ•°ç»„é‡Œé¢æ‰€æœ‰çš„æˆå‘˜å®æ–½æŸä¸ª'å‡½æ•°',è€Œæˆ‘ä»¬çš„å‡½æ•°
å…¶å®ä¹Ÿæ²¡å¿…è¦ä½¿ç”¨named
<div class="org-src-container">

<pre class="src src-js">var names = ["Fred", "Wilma", "Pebbles"];
var upper = names.map(function(name) {
    return name.toUpperCase();
});
upper;                          // ["FRED", "WILMA", "PEBBLES"]
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3">Item 20: Use call to Call Methods with a Custom Receiver</h3>
<div class="outline-text-3" id="text-3-3">
<ul class="org-ul">
<li>ä¸€èˆ¬æ¥è¯´,functionæˆ–è€…methodçš„è°ƒç”¨è€…æ˜¯å›ºå®šçš„,æ¯”å¦‚methodçš„callerå°±æ˜¯methodå‰
é¢çš„object
</li>
<li>ä½†æ˜¯æœ‰äº›æ—¶å€™,æˆ‘ä»¬éœ€è¦ä½¿ç”¨ç‰¹å®šçš„receiveræ¥è°ƒç”¨å‡½æ•°,å½“ç„¶äº†,æœ€ç®€å•çš„åŠæ³•æ˜¯æŠŠ
functionä½œä¸º'ç‰¹å®šreceiver'çš„caller
</li>
<li>ä½†æ˜¯è¿™ç§åšæ³•æœ‰å¾ˆå¤§é£é™©,å¹¶ä¸æ¨èä½¿ç”¨(å› ä¸ºobjecté‡Œé¢å¯èƒ½å·²ç»æœ‰åŒåå‡½æ•°)
</li>
<li>JSæä¾›äº†å†…ç½®çš„callå‡½æ•°æ¥åšè¿™ä»¶äº‹æƒ…,å¦‚ä¸‹ä¸¤ä¸ªè¯­å¥æ˜¯ç­‰ä»·çš„
<div class="org-src-container">

<pre class="src src-js">f.call(obj, arg1, arg2, arg3);
f(arg1, arg2, arg3);
</pre>
</div>
</li>
<li>è¿™ä¸ªbuild-inåŠŸèƒ½å¾ˆå®ç”¨,æ¯”å¦‚hasOwnPropertyè¿™ä¸ªå‡½æ•°å¯ä»¥ä½¿ç”¨ä»»ä½•ç±»å‹æ¥è°ƒç”¨å®ƒçš„
ä½œç”¨æ˜¯èƒ½å¤ŸæŸ¥æ‰¾æŸä¸ªpropertyæ˜¯"è‡ªå®šä¹‰çš„"è€Œä¸æ˜¯"åŸå‹é“¾"ä¸Šç»§æ‰¿æ¥çš„.
<div class="org-src-container">

<pre class="src src-js">Object.prototype.bar = 1;
var foo = { goo: undefined};

console.log(foo.bar);
console.log('bar' in foo);

console.log(foo.hasOwnProperty('bar'));
console.log(foo.hasOwnProperty('goo'));

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// 1                                              //
// true                                           //
// false                                          //
// true                                           //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>callè¿˜å¯ä»¥ç”¨æ¥è°ƒç”¨å·²ç»è¢«åˆ é™¤,æˆ–è€…è¦†ç›–çš„å‡½æ•°,æ¯”å¦‚ä¸‹é¢ä¾‹å­ä¸­çš„hasOwenProperty
<div class="org-src-container">

<pre class="src src-js">var dict = {};
var hasOwnProperty = {}.hasOwnProperty;
dict.foo = 1;
delete dict.hasOwnProperty;
console.log(hasOwnProperty.call(dict, "foo"));
console.log(hasOwnProperty.call(dict, "hasOwnProperty"));

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// true                                           //
// false                                          //
////////////////////////////////////////////////////
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-4" class="outline-3">
<h3 id="sec-3-4">Item 21: Use apply to Call Functions with Different Numbers of Arguments</h3>
<div class="outline-text-3" id="text-3-4">
<ul class="org-ul">
<li>applyæ˜¯callå‡½æ•°çš„ä¸€ä¸ªå˜ä½“,å°±æ˜¯æŠŠcallçš„ç¬¬äºŒä¸ªå‚æ•°å¼€å§‹åˆ°æœ€åä¸€ä¸ªå‡½æ•°,åˆæˆä¸€ä¸ª
æ•°ç»„å‚æ•°ä¹Ÿå°±æ˜¯è¯´,å¦‚ä¸‹ä¸¤ä¸ªå‡½æ•°æ˜¯ç­‰ä»·çš„
<div class="org-src-container">

<pre class="src src-js">func.call(obj, arg1, arg2, arg3)
func.apply(obj, [arg1, arg2, arg3])
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-5" class="outline-3">
<h3 id="sec-3-5">Item 22: Use arguments to Create Variadic Functions</h3>
<div class="outline-text-3" id="text-3-5">
<ul class="org-ul">
<li>variadic functionæ˜¯éå¸¸å¥½ç”¨çš„å‡½æ•°å½¢å¼,å› ä¸ºå®ƒå¯ä»¥ä½¿ç”¨"ä»»æ„é•¿åº¦"çš„å‚æ•°,ç”±äºjs
é‡Œé¢argumentsçš„å­˜åœ¨,æ‰€ä»¥è‡ªå·±å†™ä¸€ä¸ªvariadic functionæ˜¯éå¸¸å®¹æ˜“çš„
<div class="org-src-container">

<pre class="src src-js">function average() {
    for (var i = 0, sum = 0, n = arguments.length;
         i &lt; n;
         i++) {
        sum += arguments[i];
    }
    return sum / n;
}
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-6" class="outline-3">
<h3 id="sec-3-6">Item 23: Never Modify the arguments Object</h3>
<div class="outline-text-3" id="text-3-6">
<ul class="org-ul">
<li>argumentsåªæ˜¯çœ‹èµ·æ¥åƒArray,ä½†æ˜¯å´å¹¶ä¸æ˜¯çœŸçš„Array,æ‰€ä»¥ä¸è¦æ›´æ”¹argumentsçš„å†…
å®¹
</li>
<li>å¦‚æœæƒ³ä½¿ç”¨argumentsçš„å†…å®¹,é‚£ä¹ˆæˆ‘ä»¬å¾—æŠŠargumentsçš„å†…å®¹å…ˆå­˜æ”¾åˆ°ä¸€ä¸ªarrayé‡Œé¢
<div class="org-src-container">

<pre class="src src-js">console.log([0, 1, 2, 3, 4, 5].slice(2));

function callMethod() {
    var args = [].slice.call(arguments, 2);
    console.log(args);
}

callMethod(0, 1, 2, 3, 4, 5);

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// [ 2, 3, 4, 5 ]                                 //
// [ 2, 3, 4, 5 ]                                 //
////////////////////////////////////////////////////
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-7" class="outline-3">
<h3 id="sec-3-7">Item 24: Use a Variable to Save a Reference to arguments</h3>
<div class="outline-text-3" id="text-3-7">
<ul class="org-ul">
<li>iterator æ˜¯ä¸€ä¸ªå¸¸è§çš„è®¾è®¡æ¨¡å¼,åœ¨jsé‡Œé¢çš„çš„å®ç°çš„è¯,ä¸çŸ¥é“jsçš„ç»†èŠ‚çš„è¯,æˆ‘ä»¬
å¯ä»¥å®ç°ä¸€ä¸ªå¦‚ä¸‹çš„ç‰ˆæœ¬
<div class="org-src-container">

<pre class="src src-js">function values() {
    var i = 0, n = arguments.length;
    return {
        hasNext: function() {
            return i &lt; n;
        },
        next: function() {
            if (i &gt;= n) {
                throw new Error("endo of iteration");
            }
            return arguments[i++];
        }
    };
}

var i = values(0, 1, 2, 3, 4, 5, 6);
console.log(i.next());

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// undefined                                      //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>è¿™ä¸ªç‰ˆæœ¬çš„ç»“æœæœ‰ç‚¹å‡ºä¹äººä»¬çš„æ„æ–™,åŸå› æ˜¯argumentsæ˜¯æ¯ä¸ªå‡½æ•°éƒ½æœ‰çš„,æ‰€ä»¥æˆ‘ä»¬è°ƒ
ç”¨nextçš„æ—¶å€™,å…¶å®æ˜¯è°ƒç”¨çš„nextè‡ªå·±çš„arguments,è€Œä¸æ˜¯values()çš„arguments,æ‰€ä»¥
æˆ‘ä»¬è¦ä½¿ç”¨å¦‚ä¸‹çš„æ›´æ”¹
<div class="org-src-container">

<pre class="src src-js">function values() {
    var i = 0, n = arguments.length, a = arguments;
    return {
        hasNext: function() {
            return i &lt; n;
        },
        next: function() {
            if (i &gt;= n) {
                throw new Error("endo of iteration");
            }
            return a[i++];
        }
    };
}

var i = values(0, 1, 2, 3, 4, 5, 6);
console.log(i.next());
console.log(i.next());

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// 0                                              //
// 1                                              //
////////////////////////////////////////////////////
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-8" class="outline-3">
<h3 id="sec-3-8">Item 25: Use bind to Extract Methods with a Fixed Receiver</h3>
<div class="outline-text-3" id="text-3-8">
<ul class="org-ul">
<li>objectçš„propertyå¯ä»¥æ˜¯function,ä½†æ˜¯è¿™ä¸ªfunctionåœ¨"è°ƒç”¨é‚£ä¸€åˆ»"çš„thisæ˜¯ç»‘å®šçš„
ä¸åŒçš„object,æ‰€ä»¥ç›´æ¥æŠŠobjecté‡Œé¢çš„function propertyæå–å‡ºæ¥,ç„¶ååœ¨å…¶ä»–çš„åœ°
æ–¹"å½“åšmethodä½¿ç”¨(ä¹Ÿå°±æ˜¯objectä¸ä¸€å®š)"çš„æ—¶å€™,å¯èƒ½ä¼šå‡ºç°é”™è¯¯,å› ä¸º"æå–"method
çš„è¿‡ç¨‹,å¹¶ä¸èƒ½ä¸€å¹¶"æå–"object
</li>
<li>ä¸‹é¢çš„ä¾‹å­ä¼šå‡ºç°é”™è¯¯ï¼Œå› ä¸ºforEachåœ¨è°ƒç”¨buffer.addè¿™ä¸ªmethodçš„æ—¶å€™,å¹¶æ²¡æœ‰èƒ½åŠ›
çŸ¥é“buffer.addçš„thisæ˜¯è°,å®ƒåªå¥½ç”¨äº†global objectä½œä¸ºäº†default receiver.è€Œ
global objectå¹¶æ²¡æœ‰entries,æ‰€ä»¥pushå°±ä¼šè¢«è®¤ä¸ºæ˜¯ä½¿ç”¨åœ¨äº†undefined objectä¸Šé¢
<div class="org-src-container">

<pre class="src src-js">var sources = ["867", "-", "5309"];

var buffer = {
    entries: [],
    add: function(s) {
        this.entries.push(s);
    },
    concat: function() {
        return this.entries.join("");
    }
};

sources.forEach(buffer.add);
console.log(buffer.concat());

/////////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt;      //
// TypeError: Cannot read property 'push' of undefined //
/////////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>å¹¸è¿çš„æ˜¯forEachæ„è¯†åˆ°å®ƒå¯èƒ½ä¼šè°ƒç”¨ä¸€äº›method,æ‰€ä»¥forEachå¯ä»¥æ·»åŠ ç¬¬äºŒä¸ªå‚æ•°æ¥
è®¾ç½®default receiver
<div class="org-src-container">

<pre class="src src-js">source.forEach(buffer.add, buffer);
buffer.concat();                // "867-5309"
</pre>
</div>
</li>
<li>ä½†æ˜¯å¹¶ä¸æ˜¯æ‰€æœ‰çš„functionéƒ½å¦‚æ­¤çš„æœ‰ç¤¼è²Œ,ä¼šæä¾›ä¸€ä¸ªç¬¬äºŒå‚æ•°è®©æˆ‘ä»¬æ¥æŒ‡å®šdefault
receiver.æ‰€ä»¥éœ€è¦ä¸€ä¸ªæ›´é€šç”¨çš„æ–¹æ¡ˆï¼ŒES5ç»™äº†æˆ‘ä»¬ç­”æ¡ˆå°±æ˜¯bind,bindæ˜¯æ‰€æœ‰çš„
object.propertyéƒ½æ‹¥æœ‰çš„ä¸€ä¸ªå‡½æ•°
<div class="org-src-container">

<pre class="src src-js">var sources = ["867", "-", "5309"];

var buffer = {
    entries: [],
    add: function(s) {
        this.entries.push(s);
    },
    concat: function() {
        return this.entries.join("");
    }
};

sources.forEach(buffer.add.bind(buffer));
console.log(buffer.concat());

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// 867-5309                                       //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>éœ€è¦æ³¨æ„çš„æ˜¯,bindä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„å‡½æ•°(åªä¸è¿‡receiverä¸åŒ),è¿™æ˜¯ä¸€ç§æ›´å®‰å…¨çš„å¤„
ç†æ–¹å¼,å› ä¸ºè¿™æ ·bindäº§ç”Ÿçš„å‡½æ•°å¯ä»¥æ”¾å¿ƒå¤§èƒ†çš„è¢«share
</li>
<li>å¦‚æœä¸æ”¯æŒES5å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„ä¸´æ—¶æ–¹æ¡ˆ
<div class="org-src-container">

<pre class="src src-js">source.forEach(function(s) {
    buffer.add(s);
});
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-9" class="outline-3">
<h3 id="sec-3-9">Item 26: Use bind to Curry Functions</h3>
<div class="outline-text-3" id="text-3-9">
<ul class="org-ul">
<li>bindå‡½æ•°å¹¶ä¸æ˜¯åªèƒ½ç”¨æ¥æŒ‡å®šreceiver,æœ‰æ—¶å€™receiverå°±æ˜¯global object(æˆ–è€…æ— æ‰€
è°“æ˜¯è°)çš„æ—¶å€™,æˆ‘ä»¬ä¾ç„¶å¯ä»¥ä½¿ç”¨bindå‡½æ•°æ¥è¾¾åˆ°ç®€åŒ–ä»£ç çš„ç›®çš„
</li>
<li>æ¯”å¦‚curry functionå°±æ˜¯è¿™æ ·ä¸€ç§æƒ…å†µ,è¿™ç§æƒ…å†µçš„ç‰¹ç‚¹æ˜¯:
<ul class="org-ul">
<li>receiver æ— æ‰€è°“,æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬è®¾ç½®ä¸ºnullæˆ–è€…undefined,ä¹Ÿå°±æ˜¯bindçš„ä¸€ä¸ªå‚æ•°
æ˜¯nullæˆ–è€…undefined
</li>
<li>bindä»ç¬¬äºŒä¸ªå‚æ•°å¼€å§‹åˆ°æœ€åä¸€ä¸ªå‚æ•°,éƒ½æ˜¯åŸæ¥è°ƒç”¨éœ€è¦çš„å‚æ•°(å¦‚æœæ˜¯mapæˆ–è€…
forEach,é‚£ä¹ˆæœ€åä¸€ä¸ªå‚æ•°ä¸ç”¨æä¾›)
</li>
</ul>
</li>
<li>çœ‹ä¸€ä¸ªä¸ä½¿ç”¨curryçš„ä¾‹å­
<div class="org-src-container">

<pre class="src src-js">function simpleURL(protocol, domain, path) {
    return protocol + "://" + domain + "/" + path;
}

var urls = paths.map(function(path) {
    return simpleURL("http", siteDomain, path);
});
</pre>
</div>
</li>
<li>ä½¿ç”¨äº†curryä»¥å,æ˜¾ç„¶æ›´åŠ ç®€æ´
<div class="org-src-container">

<pre class="src src-js">var urls = paths.map(simpleURL.bind(null, "http", siteDomain));
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-10" class="outline-3">
<h3 id="sec-3-10">Item 27: Prefer Closures to Strings for Encapsulating Code</h3>
<div class="outline-text-3" id="text-3-10">
<ul class="org-ul">
<li>functionæ˜¯æ¯”stringæ›´å¥½çš„ä¸€ç§æŠŠcodeå­˜å‚¨æˆdata structureçš„æ–¹å¼
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-11" class="outline-3">
<h3 id="sec-3-11">Item 28: Avoid Relyingon the toString Method of Functions</h3>
<div class="outline-text-3" id="text-3-11">
<ul class="org-ul">
<li>ä¸è¦ä¾èµ–JSé‡Œé¢å‡½æ•°çš„toString()ç»“æœ,å› ä¸ºæœ‰äº›å‡½æ•°æ˜¯ä½¿ç”¨c++ä¹¦å†™çš„
<div class="org-src-container">

<pre class="src src-js">var s1 = (function(x)  {
    return x + 1;
}).toString();

var s2 = (function(x)  {
    return x + 1;
}).bind(16).toString();
console.log(s1);
console.log(s2);

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// node.exe c:/tmp/hh.js                          //
// function (x)  {                                //
//     return x + 1;                              //
// }                                              //
// function () { [native code] }                  //
////////////////////////////////////////////////////
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-12" class="outline-3">
<h3 id="sec-3-12">Item 29: Avoid Nonstandard StackInspection Properties</h3>
<div class="outline-text-3" id="text-3-12">
<ul class="org-ul">
<li>ä¸è¦ä½¿ç”¨æ ‡å‡†å¹¶ä¸æ”¯æŒçš„argument.callerå’Œargument.callee
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">Chapter 4: Objects and Prototypes</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1">Item 30: Understand the difference between prototype, getPrototypeOf, and __proto__</h3>
<div class="outline-text-3" id="text-4-1">
<ul class="org-ul">
<li>å¦‚é¢˜ç›®æ‰€ç¤º,jsé‡Œé¢å­˜åœ¨ç€ä¸‰ä¸ªç‰¹åˆ«åƒåˆæœ‰ç‚¹è”ç³»çš„æ¦‚å¿µ:
<ul class="org-ul">
<li>C.prototypeçš„ä½œç”¨æ˜¯"å»ºç«‹å’Œå®Œå–„"è¢«new()å‡½æ•°åˆ›å»ºçš„objectçš„prototypeçš„.æ³¨æ„
è¿™ä¸ªC.prototypeå¹¶ä¸æ˜¯æŒ‡å‘prototype object, å®ƒåªèƒ½ç”¨æ¥è®¾ç½®prototype object
çš„property,åªæœ‰ä¸‹é¢çš„æ–¹æ³•å¯ä»¥å–å¾—prototype object
</li>
<li>Object.getPrototype(object)æ˜¯ES5æ‰å¼•å…¥çš„æœºåˆ¶,ç”¨æ¥å–å¾—ä¸€ä¸ªobjectçš„prototype object
</li>
<li>obj.__proto__æ˜¯åœ¨ES5ä¹‹å‰çš„ä¸€ç§éå®˜æ–¹çš„å–å¾—objectçš„prototype objectçš„æ–¹æ³•
</li>
</ul>
</li>
<li>ç¬¬ä¸€ç§ç”¨æ³•çš„ä¾‹å­å¦‚ä¸‹,æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªjsçš„datatype,é‚£ä¹ˆå°±è¦æœ‰ä¸€ä¸ªctor(jsé‡Œé¢æ²¡
æœ‰class), ä¸‹é¢çš„Userå°±æ˜¯è¿™æ ·ä¸€ä¸ªctor,é™¤äº†userå’Œhashä¸¤ä¸ªattributeä»¥å¤–,è¿˜ä¸ºè¿™
ä¸¤ä¸ªattributeå„è‡ªæä¾›äº†ä¸€ä¸ªsetter,å…¶ä»£ç å¦‚ä¸‹
<div class="org-src-container">

<pre class="src src-js">function User(name, passwordHash) {
    this.name = name;
    this.passwordHash = passwordHash;
}

User.prototype.toString = function() {
    return "[User " + this.name + "]";
};

User.prototype.checkPassword = function(password) {
    return hash(password) === this.passwordHash;
};

var u = new User("sfalken", "0ef33awefswe");
</pre>
</div>
</li>
<li>è¿™é‡Œçš„æœºåˆ¶æ¯”è¾ƒå¤æ‚,æˆ‘ä»¬è¦è¯¦ç»†çš„è¯´ä¸€ä¸‹:
<ul class="org-ul">
<li>Useræœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªfunction,functionnä½œä¸ºä¸€ä¸ªfirst class object,å…¶ä¹Ÿæ˜¯å¯ä»¥æ‹¥
æœ‰propertyçš„,è€Œæ¯ä¸ªfunctionéƒ½æœ‰ä¸€ä¸ªdefaultçš„propertyå«åšprototype(å½“ç„¶è¿™ä¸ª
propertyå¦‚æœfunctionä¸ä½œä¸ºctorçš„è¯,æ²¡ä»€ä¹ˆä½œç”¨)
</li>
<li>è¿™ä¸ªdefaultçš„property,å…¶å®æ˜¯ä¸€ä¸ªobject,æ‰€ä»¥ä¸€ä¸ªobjectæ˜¯å¯ä»¥æœ‰propertyçš„,æ‰€
ä»¥è¿™é‡Œæˆ‘ä»¬èµ‹äºˆäº†è¿™ä¸ªproperty objectä¸¤ä¸ªå‡½æ•°
</li>
<li>å½“æˆ‘ä»¬è¿è¡Œnewæ¥ç”Ÿæˆ"object u"çš„æ—¶å€™,"object u"çš„prototypeå°±æŒ‡å‘äº†åˆšæ‰æˆ‘ä»¬
ç”Ÿæˆçš„"function User"çš„prototype object
</li>
</ul>
</li>
<li>ä¸Šé¢æ‰€è¿°çš„å¤æ‚çš„å…³ç³»åˆ—å›¾äºå¦‚ä¸‹

<div class="figure">
<p><img src="https://raw.githubusercontent.com/harrifeng/org_dot/master/notes/js/effective_js_prototype_all.png" alt="effective_js_prototype_all.png" />
</p>
<p><span class="figure-number">Figure 1:</span> effective_js_prototype_all.png</p>
</div>
</li>
<li>æˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯"object u"ä»æŸç§æ„ä¹‰ä¸Šæ¥è¯´,æ˜¯"ç»§æ‰¿"è‡ª"function User"çš„
prototype object:
<pre class="example">
       å½“ä½¿ç”¨u.methodnameè°ƒç”¨çš„æ—¶å€™,methodnameå¯»æ‰¾çš„é¡ºåºæ˜¯,é¦–å…ˆæŸ¥æ‰¾object u
       è‡ªå·±çš„property,å¦‚æœæ²¡æœ‰å°±æŸ¥æ‰¾object uçš„propertyçš„perperty
</pre>
</li>
<li>è€ŒES5æ–°è¿‘å¼•å…¥çš„Object.getPrototypeOf(obj)æ­£æ˜¯å–å¾—ä¸€ä¸ªå‡½æ•°çš„prototype
<div class="org-src-container">

<pre class="src src-js">function User() {
    this.password = "ello";
}

var u = new User();

console.log(Object.getPrototypeOf(u) === User.prototype);

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// true                                           //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>__proto__å°±å¾ˆå¥½è¯´äº†,è¿™å°±æ˜¯ä¸€ä¸ªéstandardçš„å–å¾—prototypeçš„æ–¹æ³•
<div class="org-src-container">

<pre class="src src-js">u.__proto__ === User.prototype  // true
</pre>
</div>
</li>
<li>æŠ½è±¡ä¸€ä¸‹å…¶ä»–è¯­è¨€é‡Œé¢classçš„æ¦‚å¿µå…¶å®å°±æ˜¯æä¾›ä¸€ä¸ªctor(ctoré‡Œé¢å…±äº«å˜é‡),å¦å¤–
æä¾›ä¸€ç³»åˆ—å…±äº«çš„å‡½æ•°(ä¸€èˆ¬åœ¨classä½“å†…,å’Œctorå¹¶åˆ—)
</li>
<li>è€Œjså…¶å®æ˜¯æŠŠå…¶ä»–è¯­è¨€é‡Œé¢çš„classçš„æ¦‚å¿µä¸€åˆ†ä¸ºäºŒ:
<ul class="org-ul">
<li>ctorå°±æ˜¯function User,å†…éƒ¨å¯ä»¥åˆå§‹åŒ–å˜é‡
</li>
<li>å…¶ä»–"ç±»å’Œè‡ªå·±çš„instance"å…±äº«çš„å‡½æ•°æ”¾åœ¨äº†User.prototypeé‡Œé¢
</li>
</ul>
</li>
<li>æˆ‘ä»¬ä½¿ç”¨ä¸‹å›¾æ¥è¡¨ç¤ºä¸€ä¸‹è¿™ä¸ªæ¦‚å¿µ

<div class="figure">
<p><img src="https://raw.githubusercontent.com/harrifeng/org_dot/master/notes/js/effective_js_prototype_class.png" alt="effective_js_prototype_class.png" />
</p>
<p><span class="figure-number">Figure 2:</span> effective_js_prototype_class.png</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2">Item 31: Prefer Object.getPrototypeOf to __proto__</h3>
<div class="outline-text-3" id="text-4-2">
<ul class="org-ul">
<li>å¾ˆæ˜¾ç„¶,ä¸€ä¸ªæ˜¯æ ‡å‡†çš„ä¸€ä¸ªæ˜¯éæ ‡å‡†çš„è‚¯å®šæ˜¯ä½¿ç”¨æ ‡å‡†çš„getPrototypeOfæœ‰æ›´å¥½çš„å¯ç§»
æ¤æ€§å•Š
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3">Item 32: Never Modify __proto__</h3>
<div class="outline-text-3" id="text-4-3">
<ul class="org-ul">
<li>æœ¬æ¥å°±ä¸æ¨èä½¿ç”¨,é‚£æ›´ä¸è¦å»ä¿®æ”¹è¿™ä¸ªå€¼å•¦.
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-4" class="outline-3">
<h3 id="sec-4-4">Item 33: Make Your Constructors new-Agnostic</h3>
<div class="outline-text-3" id="text-4-4">
<ul class="org-ul">
<li>JSçš„é—®é¢˜åœ¨äºå…¶newåé¢è·Ÿçš„æ˜¯ä¸€ä¸ªfunction,äººå®¶æ¯•ç«Ÿæ˜¯function,æ‰€ä»¥æ²¡æœ‰newçš„æƒ…
å†µä¸‹,ä¹Ÿæ˜¯å¯ä»¥è°ƒç”¨çš„.è€Œä¸”ç«Ÿç„¶åœ¨globalåŸŸé‡Œé¢äº§ç”Ÿäº†ä¸¤ä¸ªå…¨å±€å˜é‡nameå’ŒpasswordHash
<div class="org-src-container">

<pre class="src src-js">function User(name, passwordHash) {
    this.name =name;
    this.passwordHash = passwordHash;
}

var u = User("abaravelli", "d8laiabwes");
u;                              // undefined
this.name;                      // "abaravelli"
this.passwordHash               // "d8laiabwes"
</pre>
</div>
</li>
<li>ä¸Šè¿°ä»£ç åœ¨strict modeä¸‹é¢ä¸å¯ç”¨
<div class="org-src-container">

<pre class="src src-js">function User(name, passwordHash) {
    "use strict";
     this.name =name;
    this.passwordHash = passwordHash;
}

var u = User("abaravelli", "d8laiabwes");

////////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt;     //
// TypeError: Cannot set property 'name' of undefined //
////////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>æ‰€ä»¥,æˆ‘ä»¬æœ€åæä¾›ä¸€ä¸ªæœºåˆ¶(å…¶å®æ˜¯ä¸ºjså¡«å‘),è®©æœ¬æ¥ä½œä¸ºctorç”¨çš„functionä¸€æ—¦è¢«
è°ƒç”¨çš„æ—¶å€™å¿˜äº†åŠ new,æˆ‘ä»¬èƒ½æ™ºèƒ½çš„å¸®åŠ©å…¶è¿›è¡Œè¡¥æ•‘,è¿™é‡Œç”¨åˆ°äº†æˆ‘ä»¬ES5çš„æ–°ç‰¹æ€§Object.create
å…¶å‚æ•°æ˜¯ä¸€ä¸ªprototype object,å¹¶ä¸”è¿”å›ä¸€ä¸ªæ–°çš„ç»§æ‰¿è‡ªè¿™ä¸ªprototype objectçš„æ–°
çš„object.è¿ç”¨åœ¨è¿™é‡Œåˆšå¥½
<div class="org-src-container">

<pre class="src src-js">function User(name, passwordHash) {
    var self = this instanceof User ?
        this :
        Object.create(User.prototype);

    self.name = name;
    self.passwordHash = passwordHash;
}
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-5" class="outline-3">
<h3 id="sec-4-5">Item 34: Store Methods on Prototypes</h3>
<div class="outline-text-3" id="text-4-5">
<ul class="org-ul">
<li>ä¸Šé¢è®²åˆ°çš„prototypeå†™èµ·æ¥éå¸¸çš„éº»çƒ¦(å¾ˆä¸åƒå…¶ä»–è¯­è¨€ä¹¦å†™classçš„æ„Ÿè§‰),æˆ‘ä»¬å…¶å®
å¯ä»¥å¦‚ä¸‹,æŠŠmethodç›´æ¥å†™åˆ°ctoré‡Œé¢
<div class="org-src-container">

<pre class="src src-js">function User(name, passwordHash) {
    this.name = name;
    this.passwordHash = passwordHash;
    this.toString = function() {
        return "[User " + this.name + "]";
    };
    this.checkPassword = function(password) {
        return hash(password) === this.passwordHash;
    };
}
</pre>
</div>
</li>
<li>è¿™çœ‹èµ·æ¥è¿˜å¥½åƒæ˜¯"functionä½œä¸ºfirst-class object"çš„ä¸€ä¸ªä½è¯.ä½†æ˜¯è¿™æ ·åšçš„è¯,
åœ¨å¤šä¸ªinstanceéƒ½ä»è¿™ä¸ªctorè¯ç”Ÿçš„æƒ…å†µä¸‹,ä¼šæœ‰éº»çƒ¦,åˆ›å»ºå¤šä¸ªinstanceçš„ä»£ç å¦‚ä¸‹
<div class="org-src-container">

<pre class="src src-js">var u1 = new User(/* ... */);
var u2 = new User(/* ... */);
var u3 = new User(/* ... */);
</pre>
</div>
</li>
<li>éº»çƒ¦å°±æ˜¯å¦‚ä¸‹æ‰€ç¤º,æˆ‘ä»¬ä¼šå­˜å‚¨ä¸‰ä»½ä¸€æ ·çš„functionä»£ç 
<pre class="example">
                         User.prototype
                    +----+----------+----+
                    |                    |
                    +--------------------+
                   /          |           \
                  /           |            \
        prototype/            |prototype    \prototype
+---------------/      +------+--------+     \---------------+
|  .toString    |      |  .toString    |     |  .toString    |
+---------------+      +---------------+     +---------------+
|.checkPassword |      |.checkPassword |     |.checkPassword |
+---------------+      +---------------+     +---------------+
|    .name      |      |    .name      |     |    .name      |
+---------------+      +---------------+     +---------------+
| .passwordHash |      | .passwordHash |     | .passwordHash |
+---------------+      +---------------+     +---------------+
|               |      |               |     |               |
+---------------+      +---------------+     +---------------+
</pre>
</li>
<li>è€Œå¦‚æœæˆ‘ä»¬æŠŠtoStringå’ŒcheckPasswordæ”¾åˆ°ctorçš„prototypeé‡Œé¢å»çš„è¯,ç»“æœæ˜¯å¦‚ä¸‹
çš„æ ·å­.ä¸æ¯”ä¸çŸ¥é“,functionè¿˜æ˜¯æ”¾åˆ°ctorçš„prototypeé‡Œé¢å¥½, å› ä¸ºæ›´èŠ‚çœèµ„æº
<pre class="example">
                         User.prototype
                    +--------------------+
                    |    .toString       |
                    +--------------------+
                    |  .checkPassword    |
                    +--------------------+
                    |                    |
                    +--------------------+
                   /          |           \
                  /           |            \
        prototype/            |prototype    \prototype
+---------------/      +------+--------+     \---------------+
|    .name      |      |    .name      |     |    .name      |
+---------------+      +---------------+     +---------------+
| .passwordHash |      | .passwordHash |     | .passwordHash |
+---------------+      +---------------+     +---------------+
|               |      |               |     |               |
+---------------+      +---------------+     +---------------+
</pre>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-6" class="outline-3">
<h3 id="sec-4-6">Item 35: Use Closure to Store Private Data</h3>
<div class="outline-text-3" id="text-4-6">
<ul class="org-ul">
<li>JSçš„objectç³»ç»Ÿä»æ¥ä¹Ÿå°±æ²¡è€ƒè™‘è¿‡æ•°æ®å°è£…,ä¸€ä¸ªobjecté‡Œé¢å…¶æ‰€æœ‰çš„æ•°æ®éƒ½å¯ä»¥ä½¿ç”¨
å¤šç§æ–¹æ³•å–å‡º
<div class="org-src-container">

<pre class="src src-js">var obj = {
    name: 'hfeng',
    age: 30
};

console.log(Object.keys(obj));
console.log(Object.getOwnPropertyNames(obj));

for (var one in obj) {
    console.log(one);
}

////////////////////////////////////////////////////
// &lt;===================OUTPUT===================&gt; //
// [ 'name', 'age' ]                              //
// [ 'name', 'age' ]                              //
// name                                           //
// age                                            //
////////////////////////////////////////////////////
</pre>
</div>
</li>
<li>åœ¨JSçš„ä¸–ç•Œä¸­,å‘½åè§„èŒƒä¼šèµ·åˆ°"ä¸€å®šçš„"æ•°æ®å°è£…çš„ä½œç”¨,æ¯”å¦‚æ˜¯ä½¿ç”¨'_'å¼€å¤´çš„å˜é‡è¢«
     è®¤ä¸ºæ˜¯privateå˜é‡
</li>
<li>ä½†æ˜¯"å‘½åè§„èŒƒ"çš„æ•°æ®å°è£…æ–¹å¼,åªèƒ½é˜²å›å­,è€Œæ²¡æ³•å¯¹ä»˜å°äºº,JSé‡Œé¢å¯¹ä»˜å°äººçš„åŠæ³•
å°±æ˜¯closure
</li>
<li>closureåœ¨jsé‡Œé¢å€¼å¾—å¤§ä¹¦ç‰¹ä¹¦,ä½†æ˜¯æˆ‘ä»¬è¿™é‡Œåªè®²closureå’Œobjectå¯¹æ¯”èµ·æ¥çš„ä¸€ä¸ªå®Œ
å…¨"ç›¸å"çš„ç‰¹æ€§:èƒ½å¤Ÿè®¿é—®closureçš„functionæ‰æœ‰æœºä¼šè®¿é—®closureçš„æ•°æ®
<pre class="example">
The properties of an object are automatically exposed,
whereas the variables in a closure are automatically hidden
</pre>
</li>
<li>ä¸‹é¢å°±æ˜¯èƒ½å¤Ÿ"çœŸæ­£"çš„æ•°æ®å°è£…çš„ctor(è™½ç„¶è¿™ä¸ªctorè¿˜æ˜¯çŠ¯äº†åœ¨ä¸åŒinstanceä¼šé‡å¤
å­˜å‚¨functionçš„æ¯›ç—…,ä½†æ˜¯æ˜¾ç„¶æ•°æ®å°è£…æ›´é‡è¦)
<div class="org-src-container">

<pre class="src src-js">function User(name, passwordHash) {
    this.toString = function() {
        return "[User " + name + "]";
    };

    this.checkPassword = function(password) {
        return hash(password) === passwordHash;
    };
}
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-7" class="outline-3">
<h3 id="sec-4-7">Item 36: Store Instance State only on Instance Objects</h3>
<div class="outline-text-3" id="text-4-7">
<ul class="org-ul">
<li>ç†è§£prototype objectå’Œinstancesä¹‹é—´çš„one-to-manyçš„å…³ç³»è‡³å…³é‡è¦, prototypeé‡Œ
é¢å­˜å‚¨çš„åº”è¯¥æ˜¯å¤šä¸ªinstance"å¯ä»¥å…±äº«"çš„æ•°æ®,æ¯”å¦‚å‡½æ•°(å› ä¸ºå‡½æ•°æ˜¯statelessçš„).
</li>
<li>ä½†æ˜¯ä»£è¡¨äº†instanceçš„å†…éƒ¨stateçš„æ•°æ®,æ¯”å¦‚ä¸‹ä¾‹ä¸­ä¸€ä¸ªæ ‘ctoré‡Œé¢çš„childrenåˆ—è¡¨,
å°±åº”è¯¥æ˜¯ä¸åŒinstanceæ‹¥æœ‰å„è‡ªçš„åˆ—è¡¨,è€Œä¸æ˜¯å…±äº«ä¸€ä¸ª.
<div class="org-src-container">

<pre class="src src-js">function Tree(x) {
    this.value = x;
}

Tree.prototype = {
    children: [],
    addChild: function(x) {
        this.children.push(x);
    }
};
</pre>
</div>
</li>
<li>æ­£ç¡®çš„å®ç°æ–¹å¼å¦‚ä¸‹,å› ä¸ºthisä¿è¯åœ¨è¿è¡Œçš„æ—¶å€™æ˜¯ç»‘å®šè°ƒç”¨å‡½æ•°çš„instanceçš„,æ‰€ä»¥
this.childrenä¹Ÿæ˜¯å¯ä»¥æ­£ç¡®ä½¿ç”¨çš„
<div class="org-src-container">

<pre class="src src-js">function Tree(x) {
    this.value = x;
    this.children = [];
}

Tree.prototype = {
    addChild: function(x) {
        this.children.push(x)
    }
};
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-8" class="outline-3">
<h3 id="sec-4-8">Item 37: Recognize the Implicit Binding of this</h3>
<div class="outline-text-3" id="text-4-8">
<ul class="org-ul">
<li>thisåœ¨jsé‡Œé¢æœ‰ç€éå¸¸ä¸°å¯Œçš„å†…æ¶µ,å› ä¸ºjsçš„åŠ¨æ€å±æ€§,åªæœ‰åœ¨è°ƒç”¨çš„æ—¶å€™,æ‰çŸ¥é“çœŸçš„
thisæ˜¯ä»€ä¹ˆ,æ‰€ä»¥ä¼šå‡ºç°å¾ˆå¤šçš„é—®é¢˜,æ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ç”¨æ¥å¤„ç†CSVæ–‡ä»¶,å› ä¸ºCSVæ–‡ä»¶
çš„åˆ†éš”ç¬¦ä¹Ÿå¯èƒ½ä¸æ­¢æ˜¯',',æ‰€ä»¥æˆ‘ä»¬è®¾ç½®äº†ä¸€ä¸ªå‚æ•°æ¥è®¾ç½®åˆ†éš”ç¬¦
<div class="org-src-container">

<pre class="src src-js">function CSVReader(separators) {
    this.separators = separators || [","];
    this.regexp =
        new RegExp(this.separators.map(function(sep) {
            return "\\" + sep[0]; // sep[0] means strings[0] char
        }).join("|"));
}
</pre>
</div>
</li>
<li>è€Œåˆ†å‰²cvsçš„è¿‡ç¨‹ç®€å•æ¥è¯´æœ‰ä¸¤æ­¥:ç¬¬ä¸€æŠŠæ–‡ä»¶æŒ‰è¡Œåˆ†æˆå¤šä¸ª,ç¬¬äºŒæ¯ä¸€è¡Œéƒ½åˆ†æˆå¤šä¸ªå­—
ç¬¦è€Œç»„æˆçš„æ•°ç»„,è¿™ä¸ªè¿‡ç¨‹å¯ä»¥ç®€åŒ–æˆä¸€ä¸ªå‡½æ•°(æ”¾åœ¨ctorçš„prototypeé‡Œé¢)
<div class="org-src-container">

<pre class="src src-js">CSVReader.prototype.read = function(str) {
    var lines = str.trim().split(/\n/);
    return lines.map(function(line) {
        return line.split(this.regexp); // wrong here!, this point to `lines`
    });
};
</pre>
</div>
</li>
<li>ä¸Šé¢å‡ºé”™çš„åŸå› æ˜¯å› ä¸ºthiså–å†³äºæœ€è¿‘çš„enclosingå‡½æ•°(nearest enclosing function)
æ‰€ä»¥è¿™é‡Œçš„thisæŒ‡çš„æ˜¯lines
</li>
<li>å¹¸è¿çš„æ˜¯mapè¿™ä¸ªå‡½æ•°å’ŒforEachä¸€æ ·,ç»å¸¸å‡ºç°è¿™ç§é—®é¢˜,æ‰€ä»¥å¯ä»¥åŠ ä¸€ä¸ªç¬¬äºŒå‚æ•°æ¥
åˆ¶å®šå‡½æ•°å†…éƒ¨ç”¨å“ªä¸ªthis
<div class="org-src-container">

<pre class="src src-js">CSVReader.prototype.read = function(str) {
    var lines = str.trim().split(/\n/);
    return lines.map(function(line) {
        return line.split(this.regexp);
    }, this);
};
</pre>
</div>
</li>
<li>å¦‚æœmapæ²¡æä¾›è¿™ç§æ”¯æŒ(æˆ–è€…å…¶ä»–ä¸æä¾›è¿™ç§æ”¯æŒçš„å‡½æ•°),é‚£ä¹ˆæˆ‘ä»¬éœ€è¦ä½¿ç”¨self(æˆ–
è€…å…¶ä»–åå­—)åœ¨è°ƒç”¨å‰ç»‘å®šthis
<div class="org-src-container">

<pre class="src src-js">CSVReader.prototype.read = function(str) {
    var lines = str.trim().split(/\n/);
    var self = this;
    return lines.map(function(line) {
        return line.split(self.regexp);
    });
};
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-9" class="outline-3">
<h3 id="sec-4-9">Item 38: Call Superclass Constructors from Subclass Constructors</h3>
<div class="outline-text-3" id="text-4-9">
<ul class="org-ul">
<li>åœ¨æ¸¸æˆå½“ä¸­,æœ‰ä¸€ç§æ¨¡å¼å«åšScene,å°±æ˜¯åŒ…å«æ‰€æœ‰actorsçš„ä¿¡æ¯è€ŒåŒ…æ‹¬æ‰€æœ‰çš„å…³äºactors
çš„å›¾ç‰‡ç­‰ä¿¡æ¯çš„,å«åšcontext:
<ul class="org-ul">
<li>å…ˆçœ‹Scene:
<div class="org-src-container">

<pre class="src src-js">function Scene(context, width, height, images) {
    this.context = context;
    this.width = width;
    this.height = height;
    this.images = images;
    this.actors = [];
}

Scene.prototype.register = function(actor) {
    this.actors.push(actor);
}

Scene.prototype.unregister = function(actor) {
    var i = this.actors.indexOf(actor);
    if (i &gt;= 0) {
        this.actors.splice(i, 1);
    }
};

Scene.prototype.draw = function() {
    this.context.clearRect(0, 0, this.width, this.height);
    for (var a = this.actors, i = 0, n = a.length;
         i &lt; n;
         i++) {
        a[i].draw();
    }
};
</pre>
</div>
</li>
<li>å†çœ‹çœ‹Actor
<div class="org-src-container">

<pre class="src src-js">function Actor(scene, x, y) {
    this.scene = scene;
    this.x = x;
    this.y = y;
    scene.register(this);
}

Actor.prototype.moveTo = function(x, y) {
    this.x = x;
    this.y = y;
    this.scene.draw();
};

Actor.prototype.exit = function() {
    this.scene.unregister(this);
    this.scene.draw();
};

Actor.prototype.draw = function() {
    var image = this.scene.images[this.type];
    this.scene.context.drawImage(image, this.x, this.y);
};

Actor.prototype.width = function() {
    return this.scene.images[this.type].width;
};

Actor.prototype.height = function() {
    return this.scene.images[this.type].height;
};
</pre>
</div>
</li>
</ul>
</li>
<li>TODO
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">

         <!-- Disqus Comment BEGIN -->
          <div id="disqus_thread"></div>
          <script type="text/javascript">
              var disqus_shortname = 'harrifeng';

              (function() {
                  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
              })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

         <!-- Disqus Comment END -->
</div>
</body>
</html>
