<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>tii</title>
<!-- 2015-07-26 ÖÜÈÕ 18:07 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="your name" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>

         <link href="http://fonts.googleapis.com/css?family=Droid+Sans+Mono|Galdeano|Open+Sans:600italic,400,600|Roboto+Condensed:400,700" rel="stylesheet" type="text/css">
         <link rel="stylesheet" type="text/css" href="/static/css/main.css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="http://harrifeng.github.io/sitemap.html"> UP </a>
 |
 <a accesskey="H" href="http://harrifeng.github.io/index.html"> HOME </a>
</div><div id="preamble" class="status">

         <div id="header">
            <div id="header-top">
                <div id="blog-title">Harrifeng's Path</div>
                <div id="blog-sub-title">çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…,ç»çŸ¥æ­¤äº‹è¦Coding</div>
            </div>
            <div id="nav">
                <ul>
                    <li><a href="/">é¦–é¡µ</a></li>
                    <li><a href="/about.html">About Me</a></li>
                    <li>
                    </li>
                </ul>
            </div>
         </div>
</div>
<div id="content">
<h1 class="title">tii</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Chapter 01: Introduction</a>
<ul>
<li><a href="#sec-1-1">Introduction</a></li>
<li><a href="#sec-1-2">Layering</a></li>
<li><a href="#sec-1-3">TCP/IP Layering</a></li>
<li><a href="#sec-1-4">Internet Address</a></li>
<li><a href="#sec-1-5">The Domain Name System</a></li>
<li><a href="#sec-1-6">Encapsulation</a></li>
<li><a href="#sec-1-7">Demultiplexing</a></li>
<li><a href="#sec-1-8">Client-Server Model</a></li>
<li><a href="#sec-1-9">Port Numbers</a></li>
<li><a href="#sec-1-10">Standardization Process</a></li>
<li><a href="#sec-1-11">RFCs</a></li>
<li><a href="#sec-1-12">Standard, Simple Services</a></li>
<li><a href="#sec-1-13">The Internet</a></li>
<li><a href="#sec-1-14">Implementations</a></li>
<li><a href="#sec-1-15">Application Programming Interfaces</a></li>
</ul>
</li>
<li><a href="#sec-2">Chapter 02: Link Layer</a>
<ul>
<li><a href="#sec-2-1">Introduction</a></li>
<li><a href="#sec-2-2">Ethernet and IEEE 802 Encapsulation</a></li>
<li><a href="#sec-2-3">Trailer Encapsulation</a></li>
<li><a href="#sec-2-4">SLIP: Serial Line IP</a></li>
<li><a href="#sec-2-5">Compressed SLIP</a></li>
<li><a href="#sec-2-6">PPP: Point-to-Point Protocol</a></li>
<li><a href="#sec-2-7">Loopback Interface</a></li>
<li><a href="#sec-2-8">MTU</a></li>
<li><a href="#sec-2-9">Path MTU</a></li>
</ul>
</li>
<li><a href="#sec-3">Chapter 03: IP: Internet Protocol</a>
<ul>
<li><a href="#sec-3-1">Introduction</a></li>
<li><a href="#sec-3-2">IP Header</a></li>
<li><a href="#sec-3-3">IP Routing</a>
<ul>
<li><a href="#sec-3-3-1">Example</a></li>
</ul>
</li>
<li><a href="#sec-3-4">Subnet Addressin</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Chapter 01: Introduction</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">Introduction</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>ä¸åŒå‚å®¶ç”Ÿäº§çš„æ“ä½œç³»ç»Ÿä¸ä¸€çš„è®¡ç®—æœºéƒ½å¯ä»¥ä½¿ç”¨TCP/IPæ¥ç›¸äº’é€šä¿¡
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">Layering</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>ç½‘ç»œåè®®æ€»æ˜¯è¢«è®¾è®¡æˆè®¸å¤šçš„å±‚æ¬¡.æ¯ä¸ªå±‚æ¬¡è´Ÿè´£ä¸€ä¸ªæ–¹é¢çš„é€šä¿¡
</li>
<li>TCP/IPä¸ä»…ä»…æ˜¯ä¸¤ä¸ªåè®®,è€Œæ˜¯ä¸€ç»„æ´»åŠ¨åœ¨ä¸åŒå±‚æ¬¡çš„åè®®çš„æ€»ç§°.
</li>
<li>TCP/IPé€šå¸¸è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªå››å±‚åè®®, ä¸åŒå±‚æ¬¡çš„åå­—å’Œä»£è¡¨åè®®å¦‚ä¸‹:
<pre class="example">
+-----------------+
|  Application    |  Telnet, FTP, e-mail, etc
+-----------------+
|   Transport     |  TCP, UDP
+-----------------+
|    Network      |  IP, ICMP, IGMP
+-----------------+
|     Link        |  device driver and interface card
+-----------------+
</pre>
</li>
<li>æ¯ä¸€å±‚éƒ½æœ‰å…¶ç‰¹æ®Šçš„ä»»åŠ¡:
<ol class="org-ol">
<li>linkå±‚:ä¹Ÿå«æ•°æ®é“¾è·¯å±‚, åŒ…æ‹¬æ“ä½œç³»ç»Ÿä¸­çš„é©±åŠ¨ç¨‹åºå’Œé©±åŠ¨å¯¹åº”çš„ç½‘å¡.å®ƒä»¬åˆèµ·
æ¥å¤„ç†æ‰€æœ‰çš„ç‰©ç†ç»†èŠ‚.
</li>
<li>networkå±‚:å¤„ç†ç½‘ç»œä¸Šçš„packetçš„æ´»åŠ¨,"è·¯ç”±"è¿™ä¸ªåŠ¨ä½œå…¶å®å°±å‘ç”Ÿåœ¨è¿™ä¸€å±‚.è¿™ä¸€
å±‚ä¸»è¦çš„åè®®æœ‰: IP, ICMPå’ŒIGMP
</li>
<li>transportå±‚:ä¸»è¦ä¸ºapplicationå±‚æä¾›ç«¯åˆ°ç«¯çš„æ•°æ®é€šä¿¡.transportå±‚æœ‰ä¸¤ä¸ªé‡è¦
çš„åè®®:
<ul class="org-ul">
<li>TCP: æä¾›ç«¯åˆ°ç«¯çš„"å¯é (reliable)"çš„æ•°æ®é€šä¿¡, å…¶ä¸ºäº†ä¿éšœå¯é æ€§,å¯èƒ½ä¼šç”¨
åˆ°å¾ˆå¤šæŠ€æœ¯(æ¯”å¦‚æ•°æ®åˆ†ç»„, è®¾ç½®è¶…æ—¶ç­‰ç­‰). ç”±äºåœ¨TCPåè®®ä¸­ä¿è¯äº†æ•°æ®çš„å¯é 
æ€§,è°ƒç”¨TCPçš„applicationå±‚å¯ä»¥ä¸ç”¨å…³å¿ƒ"å¯é é€šä¿¡"çš„å®ç°ç»†èŠ‚
</li>
<li>UDP: æä¾›"ä¸å¯é "çš„ç«¯åˆ°ç«¯çš„æ•°æ®ä¼ è¾“. åªæ˜¯å‘é€datagramåˆ°å¯¹æ–¹host.å¹¶ä¸ä¿
è¯å¯¹æ–¹ä¸€å®šèƒ½æ¥å—åˆ°.ä½¿ç”¨UDPçš„applicationå±‚ç¨‹åºéœ€è¦è‡ªå·±æä¾›"é¢å¤–çš„éªŒè¯"æ¥
è¾¾åˆ°æ•°æ®ä¼ è¾“çš„"å¯é "
</li>
</ul>
</li>
<li>applicationè´Ÿè´£å¤„ç†ç‰¹å®šçš„åº”ç”¨ç¨‹åºçš„ç»†èŠ‚, åº”ç”¨åˆ°TCP/IPçš„applicationæœ‰:
<ul class="org-ul">
<li>è´Ÿè´£è¿œç¨‹ç™»å½•çš„Telnet
</li>
<li>è´Ÿè´£æ–‡ä»¶ä¼ è¾“çš„FTP
</li>
<li>è´Ÿè´£é‚®ä»¶ä¼ è¾“çš„SMTP
</li>
<li>è´Ÿè´£ç®€å•çš„ç½‘ç»œç®¡ç†çš„SNMP
</li>
</ul>
</li>
</ol>
</li>
<li>å‡è®¾æˆ‘ä»¬æœ‰å¦‚ä¸‹çš„ä¸¤ä¸ªhost, å®ƒä»¬åœ¨åŒä¸€ä¸ªLANé‡Œé¢,é‚£ä¹ˆå®ƒä»¬ä½¿ç”¨FTPç¨‹åºä¼ è¾“æ–‡ä»¶çš„
æ—¶å€™,ä½¿ç”¨çš„åè®®å¦‚ä¸‹æ‰€ç¤º

<div class="figure">
<p><img src="https://raw.githubusercontent.com/harrifeng/org_dot/master/notes/network/tii/ch1-ftp.png" alt="ch1-ftp.png" />
</p>
<p><span class="figure-number">Figure 1:</span> ftp.png</p>
</div>
</li>
<li>æˆ‘ä»¬ä»å›¾ä¸­å¯ä»¥å‘ç°:
<ul class="org-ul">
<li>æ¯ä¸€å±‚éƒ½ä¼šæœ‰å¯¹åº”çš„ç›¸åŒçš„åè®®è¿›è¡Œé€šä¿¡.
</li>
<li>applicationå±‚é€šå¸¸éƒ½æ˜¯ä¸€ä¸ªç”¨æˆ·è¿›ç¨‹,è€Œå…¶ä»–ä¸‰å±‚åˆ™éƒ½ä¸€èˆ¬åœ¨kernel codeé‡Œé¢(æ¯”
å¦‚Linux)
</li>
<li>applicationå±‚å¤„ç†processç»†èŠ‚,è€Œå…¶ä»–ä¸‰å±‚åˆ™æ˜¯å¤„ç†é€šä¿¡ç»†èŠ‚.
</li>
</ul>
</li>
<li>linkå±‚å’Œapplicationå±‚çš„åŒºåˆ†éå¸¸æ˜¾ç„¶:å‰è€…å¤„ç†ç‰©ç†é€šä¿¡,è€Œåè€…å¤„ç†ç‰¹å®šç”¨æˆ·è¿›ç¨‹.
ä½†æ˜¯ä¸ºä»€ä¹ˆè¦åˆ’åˆ†æˆnetworkå±‚å’Œtransportå±‚,å´ä¸æ˜¯å¾ˆæ˜æ˜¾èƒ½å¤Ÿçœ‹å‡ºåŸå› .éœ€è¦ä¸€äº›
è¯¦ç»†è¯´æ˜:
<ul class="org-ul">
<li>1980å¹´ä»£networkingçš„è¿…é€Ÿå´›èµ·æ˜¯å› ä¸ºäººä»¬æ„è¯†åˆ°ä¸€å°ç”µè„‘æ„æˆçš„"å­¤å²›"æ²¡æœ‰æ„ä¹‰,
æ‰€ä»¥æœ‰äº†å±€åŸŸç½‘. è€Œ1990å¹´ä»£,äººä»¬æ›´æ˜¯è¿›ä¸€æ­¥çš„å°†æ›´å¤šçš„å±€åŸŸç½‘è”ç³»è®°èµ·æ¥,ç»„æˆ
äº†"è‹±ç‰¹ç½‘"
</li>
<li>å°†ä¸åŒçš„å±€åŸŸç½‘(LAN)è”ç³»èµ·æ¥çš„æœ€å¥½çš„åŠæ³•æ˜¯å€ŸåŠ©è·¯ç”±å™¨,å› ä¸ºè·¯ç”±å™¨å¯ä»¥è¿æ¥ä¸¤ä¸ª
ç±»å‹å®Œå…¨ä¸åŒçš„å±€åŸŸç½‘(LAN),ä¸‹å›¾å°±æ˜¯ä¸€ä¸ªé€šè¿‡è·¯ç”±å™¨è¿æ¥çš„ä¸¤ä¸ªLAN(ä¸€ä¸ªæ˜¯ä»¥å¤ªç½‘,
å¦å¤–ä¸€ä¸ªæ˜¯ä»¤ç‰Œç½‘)é‡Œé¢çš„ä¸¤ä¸ªhost

<div class="figure">
<p><img src="https://raw.githubusercontent.com/harrifeng/org_dot/master/notes/network/tii/ch1-tcp-ip.png" alt="ch1-tcp-ip.png" />
</p>
<p><span class="figure-number">Figure 2:</span> tcp-ip.png</p>
</div>
</li>
<li>ä»ä¸Šå›¾å¯ä»¥å¾—åˆ°transportå±‚å’Œinternetå±‚å¿…é¡»åˆ†å¼€çš„ä¸¤ä¸ªåŸå› :
<ol class="org-ol">
<li>æˆ‘ä»¬çš„FTP å®¢æˆ·ç«¯å’ŒFTPæœåŠ¡å™¨ç«¯å«åšend system. è€Œè·¯ç”±å™¨åˆ™å«åšintermediate
system. æˆ‘ä»¬çš„TCPåè®®"ä»…ä»…"ä¼šè¢«end systemæ‰€ä½¿ç”¨(ä¹Ÿå°±æ˜¯clientå’Œserverçš„
networkå±‚), è€Œæˆ‘ä»¬çš„IPåè®®,åˆ™ä¸ä»…ä»…è¢«end systemä½¿ç”¨,è¿˜ä¼šè¢«intermediate
systemæ‰€ä½¿ç”¨
</li>
<li>IPæä¾›çš„æ˜¯"ä¸å¯é "æœåŠ¡,å®ƒå°½å…¶æ‰€èƒ½çš„ä¼ è¾“IP packet.è€ŒTCPåˆ™æ˜¯é€šè¿‡è¶…å¸‚é‡ä¼ ,
å‘é€å’Œæ¥å—ç«¯åˆ°ç«¯çš„"ç¡®è®¤åˆ†ç»„"ç­‰æœºåˆ¶æ¥è¾¾åˆ°"å¯é "ä¼ è¾“çš„ç›®çš„.æ‰€ä»¥ä¸¤è€…çš„"æ™º
èƒ½"æ˜¯å®Œå…¨ä¸åŒçš„.
</li>
</ol>
</li>
</ul>
</li>
<li>ä¸‹é¢åŒºåˆ†ä¸¤ä¸ªæ¦‚å¿µ:
<ul class="org-ul">
<li>router(è·¯ç”±å™¨)æ˜¯è¿æ¥ä¸¤ä¸ªLAN,ä¸¤ä¸ªLANçš„ç±»å‹å¯èƒ½ä¸ä¸€æ ·(ä¸€ä¸ªæ˜¯ä»¥å¤ªç½‘,å¦ä¸€ä¸ªå¯èƒ½æ˜¯ä»¤ç‰Œç½‘)
</li>
<li>bridge(ç½‘æ¡¥)æ˜¯æŠŠåŒç±»çš„ä¸¤ä¸ªLANç»„åˆæˆä¸€ä¸ªæ›´å¤§çš„LAN.
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">TCP/IP Layering</h3>
<div class="outline-text-3" id="text-1-3">
<ul class="org-ul">
<li>ä¸‹å›¾å°±æ˜¯æˆ‘ä»¬å°†è¦è®¨è®ºçš„TCP/IPåè®®ç°‡é‡Œé¢çš„åè®®

<div class="figure">
<p><img src="https://raw.githubusercontent.com/harrifeng/org_dot/master/notes/network/tii/ch1-suite.png" alt="ch1-suite.png" />
</p>
<p><span class="figure-number">Figure 3:</span> suite.png</p>
</div>
</li>
<li>TCPå’ŒUPDæ˜¯æœ€ä¸»è¦çš„è¿è¾“å±‚åè®®, å®ƒä»¬éƒ½ä½¿ç”¨IPä½œä¸ºç½‘ç»œå±‚åè®®
</li>
<li>IPæ˜¯ç½‘ç»œå±‚ä¸Šçš„ä¸»è¦åè®®,è¢«TCPå’ŒUDPæ‰€ä½¿ç”¨.ä¹Ÿæœ‰å¾ˆå°‘æƒ…å†µä¸‹ç”¨æˆ·è¿›ç¨‹ä¼šç›´æ¥è°ƒç”¨IPåè®®.
</li>
<li>ICMPæ˜¯æ˜¯IPçš„é™„å±ç®¡ç†åè®®, IPå±‚ç”¨æ¥å’Œå…¶ä»–IPå±‚(å¯èƒ½æ¥è‡ªå…¶ä»–hostæˆ–è€…å…¶ä»–è·¯ç”±å™¨)
äº¤æ¢é”™è¯¯æŠ¥æ–‡,æˆ–è€…å…¶ä»–é‡è¦ä¿¡æ¯.åº”ç”¨ç¨‹åºå¯ä»¥ç›´æ¥ä½¿ç”¨ICMP,æ¯”è¾ƒè‘—åçš„ä¸¤ä¸ªç¨‹åºæ˜¯:
<ul class="org-ul">
<li>Ping
</li>
<li>Traceroute
</li>
</ul>
</li>
<li>IGMPè¢«multicastingæ‰€ä½¿ç”¨: å‘é€ä¸€ä¸ªUDP datagramåˆ°å¤šä¸ªhost.
</li>
<li>ARPå’ŒRARPæ˜¯Linkå±‚æ‰€ä½¿ç”¨çš„åè®®,ç”¨æ¥å¯¹IPåœ°å€å’Œç‰©ç†åœ°å€è¿›è¡Œç›¸äº’è½¬æ¢.
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4">Internet Address</h3>
<div class="outline-text-3" id="text-1-4">
<ul class="org-ul">
<li>åœ¨äº’è”ç½‘ä¸Š,æ¯ä¸ªinterfaceéƒ½å¿…é¡»æœ‰ä¸€ä¸ªinternet address(ä¹Ÿå«IPåœ°å€).IPåœ°å€åˆ†ä¸º
äº”ç±»:
<pre class="example">
           7 bits                     24 bits
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
A    |0|   netid     |               hostid                          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                 14 bits                       16 bit
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
B    |1|0|        netid              |         hostid                |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                       21 bits                             8 bits
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
C    |1|1|0|           netid                         |    hostid     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                      28 bits
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
D    |1|1|1|0|                 multicast group ID                    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                                      28 bits
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
E    |1|1|1|1|                 reserved for future used              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</li>
<li>é€šå¸¸æŠŠ32bitçš„åœ°å€æ¯8ä¸ªbitä¸€ç»„ç”¨dotéš”å¼€,å°±æ˜¯å¸¸è§çš„åœ°å€æ ¼å¼,è€Œé€šè¿‡çœ‹ç¬¬ä¸€ä½çš„
æ•°å­—,å°±è‚¯å®šå¯ä»¥çœ‹å‡ºè¿™ä¸ªåœ°å€å±äºå“ªä¸€ç±»åœ°å€.å› ä¸ºæ¯ç±»åœ°å€æœ€å¼€å§‹çš„æ•°å­—è‚¯å®šæ˜¯Nä¸ª
1åŠ 8-Nä¸ªé›¶çš„ç»„åˆ.ä¹Ÿå°±æ˜¯
<pre class="example">
A =&gt; From 00000000.x.x.x  =  0.x.x.x
B =&gt; From 10000000.x.x.x  =  2**7.x.x.x = 128.0.0.1
C =&gt; From 11000000.x.x.x  =  (2**7 + 2**6).x.x.x = 192.x.x.x
D =&gt; From 11100000.x.x.x  =  (2**7 + 2**6 + 2**5).x.x.x = 224.x.x.x
E =&gt; From 11110000.x.x.x  =  (2**7 + 2**6 + 2**5 + 2**4).x.x.x = 240.x.x.x
</pre>
</li>
<li>éœ€è¦å†æ¬¡å¼ºè°ƒçš„æ˜¯IPåœ°å€æ˜¯æ¯ä¸ªç½‘ç»œæ¥å£ä¸€ä¸ª,å¤šæ¥å£ä¸»æœºå°±ä¼šæœ‰å¤šä¸ªIPåœ°å€
</li>
<li>IP åœ°å€ä¸ä»…ä»…åˆ†äº†ABCDEäº”ç±»,è¿™äº”ç±»ä¸­è¿˜ä¼šæœ‰ä¸€äº›çš„åœ°å€æ˜¯åšç‰¹æ®Šç”¨é€”çš„:
<ul class="org-ul">
<li>å½“å‰hostæ‰€åœ¨ç½‘ç»œé‡Œé¢çš„æ‰€æœ‰ä¸»æœº:multicast
</li>
<li>æŸä¸ªç½‘ç»œé‡Œé¢çš„æ‰€æœ‰ä¸»æœº:broadcast
</li>
<li>é™¤äº†ä¸Šè¿°ä¸¤ç§ç‰¹æ®Šç”¨é€”çš„IPåœ°å€,å…¶ä»–çš„IPåœ°å€éƒ½æ˜¯ç›®çš„ä¸ºå•ä¸ªhostçš„åˆ¶åº¦:unicast
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5">The Domain Name System</h3>
<div class="outline-text-3" id="text-1-5">
<ul class="org-ul">
<li>äººç±»è¿˜æ˜¯æ›´å–œæ¬¢ä½¿ç”¨è‹±è¯­,è€Œä¸æ˜¯æ•°å­—æ¥è®°å¿†ç½‘ç«™,DNSæ­£æ˜¯è¿™æ ·ä¸€ç§åˆ†å¸ƒå¼æ•°æ®åº“
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-6" class="outline-3">
<h3 id="sec-1-6">Encapsulation</h3>
<div class="outline-text-3" id="text-1-6">
<ul class="org-ul">
<li>å½“åº”ç”¨ç¨‹åºé€šè¿‡TCPå‘é€ç½‘ç»œä¿¡æ¯çš„æ—¶å€™,ä»transportå±‚å¼€å§‹,åˆ°linkå±‚ç»“æŸ,æ¯ä¸€å±‚éƒ½
encapsulateäº†ä¸€äº›ä¿¡æ¯.å¦‚ä¸‹å›¾

<div class="figure">
<p><img src="https://raw.githubusercontent.com/harrifeng/org_dot/master/notes/network/tii/ch1-encapsulation.png" alt="ch1-encapsulation.png" />
</p>
<p><span class="figure-number">Figure 4:</span> encapsulation.png</p>
</div>
</li>
<li>ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»ä¸Šåˆ°ä¸‹,æ•°æ®çš„åå­—å‘ç”Ÿäº†æ”¹å˜:
<ul class="org-ul">
<li>TCPå‘é€ç»™IPçš„å«åšTCP Segment
</li>
<li>IPå‘é€ç»™network interfaceçš„å«åšIP datagram
</li>
<li>åœ¨ä»¥å¤ªç½‘ä¸Šé¢ç›¸äº’ä¼ è¾“çš„å«åšEthernet frame
</li>
</ul>
</li>
<li>Ethernetçš„frameæ˜¯åœ¨IP datagramçš„åŸºç¡€ä¸Šå°è£…äº†Ethernet headerå’ŒEthernet trailer
è€Œç»„æˆçš„.IP datagramå¡«å……Ethernet frameçš„dataéƒ¨åˆ†,Ethernetåè®®è§„å®šäº†è¿™ä¸ªéƒ¨åˆ†
çš„å¤§å°åŒºé—´
<pre class="example">
46 bytes to 1500 bytes
</pre>
</li>
<li>å¦‚æœæˆ‘ä»¬ç”»ä¸€ä¸ªUDPçš„å›¾,ä¼šå’ŒTCPçš„éå¸¸ç›¸ä¼¼,ä¸åŒçš„æ˜¯UDPçš„ä¼ é€’ç»™IPçš„æ•°æ®å«åš
UDP datagram.
</li>
<li>æˆ‘ä»¬å‰é¢å†™è¿‡, TCP, UDP, ICMP, IGMPéƒ½ä¼šå‘é€æ•°æ®ç»™IP. æ‰€ä»¥IPå¿…é¡»åœ¨IP headeré‡Œ
é¢æ·»åŠ è¯†åˆ«ä¿¡æ¯.è¿™ä¸ªè¯†åˆ«ä¿¡æ¯é•¿åº¦ä¸º8bit,åœ¨IP headeré‡Œé¢å«åšprotocol field:
<ul class="org-ul">
<li>ICMP ä¸º 1
</li>
<li>IGMP ä¸º2
</li>
<li>TCP ä¸º 6
</li>
<li>UDP ä¸º 17
</li>
</ul>
</li>
<li>å’ŒIPä¸€æ ·, TCP/UDPä¹Ÿå¿…é¡»åœ¨è‡ªå·±çš„headeré‡Œé¢è®¾ç½®è¯†åˆ«applicationå±‚çš„ä¿¡æ¯, ä¹Ÿå°±
æ˜¯è¯†åˆ«ä¸åŒçš„process. è¿™ä¸ªè¯†åˆ«ä¿¡æ¯å°±æ˜¯port number(è€Œä¸”æ˜¯sourceå’Œdestination
port number)
</li>
<li>network interfaceå¯ä»¥ä¸ºIPå’ŒARP,RARPæä¾›æœåŠ¡,å®ƒä»¬è¯†åˆ«IP, ARP,RARPçš„æ–¹æ³•æ˜¯16-bit
çš„ frame type field
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-7" class="outline-3">
<h3 id="sec-1-7">Demultiplexing</h3>
<div class="outline-text-3" id="text-1-7">
<ul class="org-ul">
<li>å’Œå°è£…(encapsulation)ç›¸å¯¹çš„å°±æ˜¯åˆ†ç”¨(demultiplexing): ä¹Ÿå°±æ˜¯æŠŠ"åº•å±‚"çš„Ethernet
æ•°æ®"å±‚å±‚å»æ‰é¦–éƒ¨"ç„¶åå‘é€ç»™application. å¦‚ä¸‹å›¾

<div class="figure">
<p><img src="https://raw.githubusercontent.com/harrifeng/org_dot/master/notes/network/tii-ch1-demultiplexing.png" alt="tii-ch1-demultiplexing.png" />
</p>
<p><span class="figure-number">Figure 5:</span> tti-ch1-demultiplexing.png</p>
</div>
</li>
<li>ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°.å¦‚æœä»dmultiplexingçš„è§’åº¦è®²:
<ul class="org-ul">
<li>æœ¬æ¥åœ¨networkå±‚çš„IGMPå’ŒICMPç°åœ¨ä¸Šç§»åˆ°äº†transportå±‚,å› ä¸ºå®ƒä»¬éƒ½æ˜¯è¢«networkå±‚
çš„IPåè®®å°è£…çš„.æ¢å¥è¯è¯´,IGMPå’ŒICMPå’ŒTCP/UDPçš„å¾…é‡ä¸€æ ·,åœ¨IPå¤´éƒ¨ä¸­æœ‰typeåŸŸ
æ¥è¿›è¡Œæ ‡ç¤º.(ICMPä¸º1, IGMPä¸º2, TCPä¸º6, UDPä¸º17)
</li>
<li>æœ¬æ¥åœ¨linkå±‚çš„ARP, RARPç°åœ¨ä¸Šç§»åˆ°äº†networkå±‚. å› ä¸ºå®ƒä»¬éƒ½æ˜¯è¢«linkå±‚çš„Ethernet
åè®®æ‰€å°è£…çš„.æ¢å¥è¯è¯´,ARP,RARPå’ŒIPçš„å¾…é‡ä¸€æ ·,éƒ½æ˜¯åœ¨Ethernetå¤´éƒ¨æœ‰typeåŸŸæ¥
è¿›è¡Œæ ‡ç¤º(0800ä¸ºIP, 0806ä¸ºARP, 0835ä¸ºRARP)
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-8" class="outline-3">
<h3 id="sec-1-8">Client-Server Model</h3>
<div class="outline-text-3" id="text-1-8">
<ul class="org-ul">
<li>å¤§éƒ¨åˆ†ç½‘ç»œåº”ç”¨éƒ½è‡ªç„¶çš„æŠŠé€šä¿¡çš„ä¸¤ç«¯è®¾ç½®ä¸ºä¸€ç«¯ä¸ºclient,å¦ä¸€ç«¯ä¸ºserver. server
ä¸ºclientæä¾›æŸç§æœåŠ¡.
</li>
<li>è€Œæ ¹æ®serverç«¯æ˜¯å¦èƒ½åŒæ—¶å¤„ç†å¤šä¸ªclientè¯·æ±‚,æŠŠserveråˆ†æˆä¸¤ç§:
<ul class="org-ul">
<li>iterative server:æ¯æ¬¡åªèƒ½å¤„ç†ä¸€ä¸ªclientè¯·æ±‚
</li>
<li>concurrent server:é€šè¿‡æŠŠä»»åŠ¡åˆ†é…ç»™å¦å¤–ä¸€ä¸ªprocess(æˆ–è€…thread), å¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªclientè¯·æ±‚
</li>
</ul>
</li>
<li>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹TCP serveræ˜¯ä¸€concurrentçš„,è€ŒUDP serveræ˜¯iterativeçš„
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-9" class="outline-3">
<h3 id="sec-1-9">Port Numbers</h3>
<div class="outline-text-3" id="text-1-9">
<ul class="org-ul">
<li>æˆ‘ä»¬è¯´è¿‡,TCPå’ŒUDPåŒºåˆ†ä¸åŒapplicationçš„æ–¹æ³•æ˜¯port number. å®ƒä»¬çš„headerä¸­éƒ½æœ‰
ä¸€ä¸ª16bitçš„fieldæ¥å­˜å‚¨è¿™ä¸ªport number(ä¹Ÿå°±æ˜¯0~65535)
</li>
<li>å¯¹äºport numberçš„æ€åº¦, clientå’Œserverä¹Ÿæ˜¯æœ‰æ‰€ä¸åŒçš„:
<ul class="org-ul">
<li>æŸä¸ªåº”ç”¨çš„serverç«¯å£çš„numberç›¸å¯¹å›ºå®š:
<ul class="org-ul">
<li>å¦‚æœæ˜¯å¤šç§æ“ä½œç³»ç»Ÿéƒ½æ”¯æŒçš„Internet-wideåº”ç”¨,ä¸€èˆ¬serverç«¯çš„ç«¯å£é€šå¸¸åœ¨1~255
</li>
<li>å¦‚æœä»…ä»…æ˜¯Unixç³»ç»Ÿä¸­æ”¯æŒçš„Unix-specificåº”ç”¨,ä¸€èˆ¬serverç«¯çš„ç«¯å£é€šå¸¸åœ¨256~1023
</li>
</ul>
</li>
<li>æŸä¸ªåº”ç”¨çš„clientç«¯å£çš„é€‰æ‹©æ˜¯æ¯æ¬¡éƒ½ä¸ä¸€æ ·çš„,æ‰€ä»¥ä¼šä»1024~5000é‡Œé¢éšä¾¿é€‰æ‹©ä¸€
ä¸ªæ•°å­—,è¿™ä¸ªç«¯å£å·ä¹Ÿå«ephemeral port
</li>
</ul>
</li>
<li>å¤§äº5000çš„ç«¯å£å·ä¼šç”¨ä½œä¸å¤ªè‘—åçš„åº”ç”¨
</li>
<li>åœ¨å¤§éƒ¨åˆ†çš„Unixç³»ç»Ÿä¸­, /etc/serviceséƒ½ä¼šä¿ç•™well-knownçš„ numberå’Œä½¿ç”¨å®ƒçš„åº”ç”¨
ä¹‹é—´çš„å¯¹åº”å…³ç³»
<div class="org-src-container">

<pre class="src src-sh">% grep domain /etc/services
domain           53/udp     <span style="color: #93a1a1;"># </span><span style="color: #93a1a1; font-style: italic;">Domain Name Server uses UDP port 53</span>
domain           53/tcp     <span style="color: #93a1a1;"># </span><span style="color: #93a1a1; font-style: italic;">Domain Name Server uses TCP port 53</span>
</pre>
</div>
</li>
<li>Unixæœ‰ä¸€ç§æ¦‚å¿µå«åšreserved port.å°±æ˜¯æŠŠ1åˆ°1023ä¹‹é—´çš„æŸä¸ªportæŒ‡å®šä¸ºè‡ªå·±ä½¿ç”¨,åª
æœ‰superuseræƒé™çš„processæ‰æœ‰æŒ‡å®šreserved portçš„æƒåˆ©.
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-10" class="outline-3">
<h3 id="sec-1-10">Standardization Process</h3>
<div class="outline-text-3" id="text-1-10">
<ul class="org-ul">
<li>TCPçš„æ ‡å‡†åŒ–æœºæ„æœ‰:
<ul class="org-ul">
<li>ISOC
</li>
<li>IAB
</li>
<li>IETF
</li>
<li>IRTF
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-11" class="outline-3">
<h3 id="sec-1-11">RFCs</h3>
<div class="outline-text-3" id="text-1-11">
<ul class="org-ul">
<li>internet communityçš„æ­£å¼è§„èŒƒæˆ–è€…é‡è¦ä¿¡æ¯éƒ½æ˜¯ä»¥RFCçš„æ–¹å¼å‡ºç‰ˆ.
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-12" class="outline-3">
<h3 id="sec-1-12">Standard, Simple Services</h3>
<div class="outline-text-3" id="text-1-12">
<ul class="org-ul">
<li>ä¸€äº›å¸¸ç”¨çš„applicationå’Œç«¯å£å·å¯¹åº”å¦‚ä¸‹
<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border">


<colgroup>
<col  class="left" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Name</th>
<th scope="col" class="right">TCP port</th>
<th scope="col" class="right">UDP port</th>
<th scope="col" class="right">RFC</th>
<th scope="col" class="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">echo</td>
<td class="right">7</td>
<td class="right">7</td>
<td class="right">862</td>
<td class="left">Server returns whaetever the client sends</td>
</tr>

<tr>
<td class="left">discard</td>
<td class="right">9</td>
<td class="right">9</td>
<td class="right">863</td>
<td class="left">Server discards whatever thec  client sends</td>
</tr>

<tr>
<td class="left">daytime</td>
<td class="right">13</td>
<td class="right">13</td>
<td class="right">867</td>
<td class="left">Server returns time and date</td>
</tr>

<tr>
<td class="left">chargen</td>
<td class="right">19</td>
<td class="right">9</td>
<td class="right">864</td>
<td class="left">TCP sends continual stream of characters,</td>
</tr>

<tr>
<td class="left">&#xa0;</td>
<td class="right">&#xa0;</td>
<td class="right">&#xa0;</td>
<td class="right">&#xa0;</td>
<td class="left">until the connection is terminated by client.</td>
</tr>

<tr>
<td class="left">&#xa0;</td>
<td class="right">&#xa0;</td>
<td class="right">&#xa0;</td>
<td class="right">&#xa0;</td>
<td class="left">UDP sends a datagram containing a random number</td>
</tr>

<tr>
<td class="left">&#xa0;</td>
<td class="right">&#xa0;</td>
<td class="right">&#xa0;</td>
<td class="right">&#xa0;</td>
<td class="left">of characters each time client sends a datagram</td>
</tr>

<tr>
<td class="left">time</td>
<td class="right">37</td>
<td class="right">37</td>
<td class="right">868</td>
<td class="left">Server return the number of seconds from 1900</td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-13" class="outline-3">
<h3 id="sec-1-13">The Internet</h3>
<div class="outline-text-3" id="text-1-13">
<ul class="org-ul">
<li>å°å†™internetæŒ‡å¤šä¸ªLANè¿èµ·æ¥, é¦–å­—æ¯å¤§å†™InternetæŒ‡æ•´ä¸ªäº’è”ç½‘
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-14" class="outline-3">
<h3 id="sec-1-14">Implementations</h3>
</div>
<div id="outline-container-sec-1-15" class="outline-3">
<h3 id="sec-1-15">Application Programming Interfaces</h3>
<div class="outline-text-3" id="text-1-15">
<ul class="org-ul">
<li>ç½‘ç»œç¼–ç¨‹ä¸»è¦ç”±ä¸¤ç§API, socketå’ŒTLI, åè€…å·²è¢«æ·˜æ±°
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Chapter 02: Link Layer</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">Introduction</h3>
</div>
<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">Ethernet and IEEE 802 Encapsulation</h3>
<div class="outline-text-3" id="text-2-2">
<ul class="org-ul">
<li>Ethernet(ä»¥å¤ªç½‘)æ˜¯1982å¹´DEC,Intel,æ–½ä¹å…¬å¸è”åˆå‘æ˜çš„ä¸€ä¸ªåè®®.æ˜¯å½“ä»Šä¸–ç•Œä¸Šäº‹
å®ä¸Šçš„é»˜è®¤LANåè®®.
</li>
<li>ä»¥å¤ªç½‘çš„æ ¸å¿ƒæŠ€æœ¯æ˜¯CSMA/CDä¹Ÿå°±æ˜¯
<pre class="example">
Carrier Sense, Multiple Access with Collision Detection
å¸¦å†²çªæ£€æµ‹çš„è½½æ³¢ä¾¦å¬å¤šè·¯æ¥å…¥
</pre>
</li>
<li>äº‹æƒ…çš„å¤æ‚æ€§åœ¨äºIEEEæä¾›äº†ä¸€ç³»åˆ—å’ŒEthernetåè®®ä¸å¤ªç›¸åŒçš„è§„èŒƒ, ä¸ºäº†åŒºåˆ†,æˆ‘ä»¬
æŠŠä»–ä»¬åˆ†åˆ«ç§°ä½œ:
<ul class="org-ul">
<li>Ethernetåè®® (å½“ä»Šä¸–ç•Œäº‹å®ä¸Šçš„æ ‡å‡†)
</li>
<li>IEEE 802åè®®
</li>
</ul>
</li>
<li>åœ¨TCP/IPçš„ä¸–ç•Œé‡Œé¢,IP datagramä¹Ÿæœ‰ä¸¤ä¸ªä¸åŒçš„RFCæ¥å¯¹åº”Linkå±‚çš„ä¸åŒåè®®:
<ul class="org-ul">
<li>Ethernetåè®®çš„IP datagram: RFC894(ä¹Ÿæ˜¯å½“ä»Šä¸–ç•Œäº‹å®ä¸Šçš„æ ‡å‡†)
</li>
<li>IEEE 802åè®®çš„IP datagram: RFC1042
</li>
</ul>
</li>
<li>ä¸‹å›¾å°±æ˜¯Ethernetåè®®å’ŒIEEE 802ä¸¤ä¸ªæ ‡å‡†å¯¹åº”çš„å›¾

<div class="figure">
<p><img src="https://raw.githubusercontent.com/harrifeng/org_dot/master/notes/network/tii/ch2-ethernet-ieee802.png" alt="ch2-ethernet-ieee802.png" />
</p>
<p><span class="figure-number">Figure 6:</span> ch2-ethernet-ieee802.png</p>
</div>
</li>
<li>ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°:
<ul class="org-ul">
<li>ä¸¤ä¸ªåè®®éƒ½ä½¿ç”¨äº†48bitçš„æºåœ°å€å’Œç›®çš„åœ°å€. è¿™ä¸ª48bitçš„åœ°å€å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„ç¡¬
ä»¶åœ°å€(hardware address): ARPå’ŒRARPå°±æ˜¯ç”¨æ¥å°†32bit IPåœ°å€ä»¥åŠ48bitç¡¬ä»¶åœ°
å€è¿›è¡Œç›¸äº’è½¬æ¢çš„
</li>
<li>ä¸¤ä¸ª48bitåœ°å€ä¹‹åçš„2ä¸ªbyte,å¯¹äºä¸åŒåè®®è§£é‡Šä¸åŒ:
<ul class="org-ul">
<li>Ethernetåè®®: ç”¨ä½œtype: è¡¨æ˜æ¥ä¸‹æ¥çš„networkå±‚æ•°æ®çš„ç±»å‹:
<ol class="org-ol">
<li>0800: IP datagram
</li>
<li>0806: ARP request/reply
</li>
<li>0835: RARP request/reply
</li>
</ol>
</li>
<li>IEEE 802åè®®é‡Œé¢: ç”¨åšlength. å¹¸è¿çš„æ˜¯è¿™ä¸ªlengthæœ€å¤§ä¸º1500bytes, è€Œnetwork
å±‚æœ€å°çš„è¡¨ç¤ºIP datagramçš„typeæ˜¯0x0800(ä¹Ÿå°±æ˜¯32768)bytes. æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€š
è¿‡è¿™ä¸¤ä½æ¥åˆ†è¾¨ä¸åŒçš„åè®®.
</li>
</ul>
</li>
<li>å†ä¸¤ä¸ªbyteå:
<ul class="org-ul">
<li>Ethernetåè®®:å°±æ˜¯æ•°æ®éƒ¨åˆ†äº†
</li>
<li>IEEE 802åè®®:è¿˜æœ‰ä¸¤ä¸ªéƒ¨åˆ†çš„æ•°æ®:
<ol class="org-ol">
<li>3 byteçš„802.2 LLC
</li>
<li>5 byteçš„802.2 SNAP(å…¶ä¸­æœ€åä¸€ä¸ªéƒ¨åˆ†æ˜¯å’ŒEthernetåè®®ä¸€æ ·çš„type)
</li>
</ol>
</li>
</ul>
</li>
<li>ä¸¤ç§åè®®æœ€åéƒ½æ˜¯CRCçš„æ ¡éªŒç 
</li>
<li>å¯¹ä¸¤ç§åè®®æ¥è¯´,éƒ½æœ‰æœ€å°é•¿åº¦çš„è¦æ±‚, å¦‚æœdataéƒ¨åˆ†æ²¡é‚£ä¹ˆå¤š,éœ€è¦å¡«å……åˆ°é›¶æ¥è¾¾
åˆ°æœ€å°é•¿åº¦:
<ul class="org-ul">
<li>Ethernetåè®®: 46bytes
</li>
<li>IEEE 802åè®®: 38bytes
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3">Trailer Encapsulation</h3>
<div class="outline-text-3" id="text-2-3">
<ul class="org-ul">
<li>å°¾éƒ¨å°è£…æ˜¯å·²ç»è¢«æ·˜æ±°çš„æŠ€æœ¯,æˆ‘ä»¬ä¸å†è¿›è¡Œè®¨è®º
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4">SLIP: Serial Line IP</h3>
<div class="outline-text-3" id="text-2-4">
<ul class="org-ul">
<li>SLIPä¹Ÿæ˜¯è¢«PPPåè®®æ‰€å–ä»£çš„è¿‡æ—¶æŠ€æœ¯,æˆ‘ä»¬ä¸å†è®¨è®º
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-5" class="outline-3">
<h3 id="sec-2-5">Compressed SLIP</h3>
<div class="outline-text-3" id="text-2-5">
<ul class="org-ul">
<li>å‹ç¼©SLIPçš„æŠ€æœ¯.ä¸è®¨è®º
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-6" class="outline-3">
<h3 id="sec-2-6">PPP: Point-to-Point Protocol</h3>
<div class="outline-text-3" id="text-2-6">
<ul class="org-ul">
<li>PPPåè®®æ˜¯Point-to-Pointåè®®çš„ç®€ç§°, å…¶åŠŸèƒ½å’ŒSLIPç›¸åŒ:éƒ½æ˜¯åœ¨ä¸²è¡Œé“¾è·¯ä¸Šé¢ä¼ è¾“
IP datagram.å½“ä½¿ç”¨ç”µè¯çº¿æ¥æ¥å…¥äº’è”ç½‘çš„æ—¶å€™,åœ¨ç”µè¯çº¿è¿™ç§ä¸²è¡Œé“¾è·¯ä¸Šé¢ä¼ è¾“IP
datagramçš„ä»»åŠ¡,å°±äº¤ç»™äº†PPP.
</li>
<li>PPPä¼˜äºSLIPçš„åœ°æ–¹æœ‰å¾ˆå¤š,ä¸»è¦çš„æ˜¯é™¤äº†IPåè®®,è¿˜æ”¯æŒå…¶ä»–åè®®,æ‰€ä»¥å¯ä»¥ç”¨æ¥åˆå§‹åŒ–
çº¿è·¯,å¹¶ä¸”åšç”¨æˆ·éªŒè¯.
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-7" class="outline-3">
<h3 id="sec-2-7">Loopback Interface</h3>
<div class="outline-text-3" id="text-2-7">
<ul class="org-ul">
<li>å¤§éƒ¨åˆ†çš„æ“ä½œç³»ç»Ÿä¸­,ä¼šæ”¯æŒä¸€ä¸ªå«åšloopback interfaceçš„æ¥å£.è®©æœ¬æœºçš„clientå’Œ
server applicationåœ¨æœ¬æœºå†…éƒ¨ç›¸äº’é€šä¿¡.
</li>
<li>ä¸€èˆ¬æ¥è¯´,éƒ½ä¼šä½¿ç”¨Aç±»åœ°å€é‡Œé¢çš„127.0.0.1æ¥ä½œä¸ºç¯å›åœ°å€
</li>
<li>å¦‚æœä»¥IP datagramçš„ç›®çš„åœ°å€æ˜¯loopback interface,é‚£ä¹ˆå®ƒåªèƒ½å­˜åœ¨äºæœ¬æœº,ç»æ— å¯
èƒ½å‡ºç°åœ¨ä»»ä½•ç½‘ç»œçš„ä¼ è¾“é‡Œé¢!
</li>
<li>ä¸€èˆ¬æˆ‘ä»¬éƒ½ä¼šæƒ³åˆ°,å¦‚æœtransportå±‚æ£€æµ‹åˆ°äº†IPåœ°å€ä¸º127.0.0.1.é‚£ä¹ˆå‰©ä¸‹çš„éƒ¨åˆ†transport
å±‚çš„å·¥ä½œå’Œå…¨éƒ¨çš„networkå±‚çš„å·¥ä½œ.éƒ½å¯ä»¥çœç•¥.ä½†æ˜¯å®é™…çš„å®ç°å´ä¸æ˜¯è¿™æ ·:å®é™…çš„
å®ç°æ˜¯åœ¨"å°è£…"çš„è¿‡ç¨‹ä¸­å³ä¾¿æ£€æµ‹åˆ°ç›®çš„IPä¸º127.0.0.1ä¹Ÿæ˜¯ä¼šç»§ç»­å°è£…. ç›®çš„ä¸º127.0.0.1
çš„IP datagramä¹Ÿä¼šå½¢æˆ.åªä¸è¿‡,è¿™ä¸ªIP datagramä¸ä¼šä¼ ç»™Linkå±‚,è€Œæ˜¯è¿”å›ç»™äº†network
å±‚. ä¸‹å›¾æ˜¯loopbackå·¥ä½œçš„æ¨¡å¼å›¾

<div class="figure">
<p><img src="https://raw.githubusercontent.com/harrifeng/org_dot/master/notes/network/tii-ch2-loopback.png" alt="tii-ch2-loopback.png" />
</p>
<p><span class="figure-number">Figure 7:</span> tti-ch2-loopback.png</p>
</div>
</li>
<li>ä»ä¸Šå›¾ä¸­,æˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“è®º:
<ul class="org-ul">
<li>ä»æœ¬æœºå‘é€åˆ°loopback interfaceåœ°å€(127.0.0.1)çš„datagraméƒ½è¦è¿›å…¥loopback
driver çš„ip input queue
</li>
<li>ä»æœ¬æœºå‘é€åˆ°multicastå’Œboardcastçš„datagramåœ¨æ”¾å…¥Ethernetä¹‹å‰,ä¹Ÿè¦æ”¾å…¥ä¸€ä¸ª
åˆ°loopback driverçš„ip input queue
</li>
<li>ä»æœ¬æœºå‘é€åˆ°æœ¬æœºä»»æ„ä¸€ä¸ªinterfaceçš„datagram(ä¸€ä¸ªæœºå™¨å¯èƒ½æœ‰å¤šä¸ªinterface)
ä¹Ÿæ˜¯å‘é€åˆ°loopback driverçš„ip input queue
</li>
</ul>
</li>
<li>çœ‹èµ·æ¥loopbackè¿™ç§èµ°å®Œtransportå±‚å’Œnetworkå±‚çš„åšæ³•æ•ˆç‡ä¸æ˜¯å¾ˆé«˜.ä½†æ˜¯å®ƒå´æå¤§
çš„ç®€åŒ–äº†è®¾è®¡. loopback driver(å®é™…ä¸Šæ˜¯ä¸ªè½¯ä»¶)å¯ä»¥çœ‹åšæ˜¯ä¸€ç§ç‰¹æ®Šçš„linkå±‚driver
åªä¸è¿‡:
<ul class="org-ul">
<li>å…¶ä»–linkå±‚driver(æ¯”å¦‚Ethernet Driver)æ˜¯å¾€Ethernetå±‚å‘é€æ•°æ®
</li>
<li>è€Œæˆ‘ä»¬çš„linkå±‚driver(ä¹Ÿå°±æ˜¯loopback driver)æ˜¯å¾€ip input queueå‘é€æ•°æ®
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-8" class="outline-3">
<h3 id="sec-2-8">MTU</h3>
<div class="outline-text-3" id="text-2-8">
<ul class="org-ul">
<li>å‰é¢æˆ‘ä»¬ä»‹ç»linkå±‚çš„æ—¶å€™,éƒ½ä»‹ç»äº†dataçš„å¤§å°æœ‰é™åˆ¶.å…·ä½“æ¥è¯´:
<ul class="org-ul">
<li>Ethernetåè®®: 1500 bytes
</li>
<li>IEEE 802åè®®: 1492 bytes
</li>
</ul>
</li>
<li>é“¾è·¯å±‚åè®®é™åˆ¶æ•°æ®å¤§å°çš„è¿™ä¸ªç‰¹æ€§å«åšMTU(Maximum Transmission Unit). æ¯ç§Link
å±‚åè®®çš„MTUä¸åŒ
<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border">


<colgroup>
<col  class="left" />

<col  class="right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Network</th>
<th scope="col" class="right">MTU(bytes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">token ring (IBM)</td>
<td class="right">17814</td>
</tr>

<tr>
<td class="left">FDDI</td>
<td class="right">4352</td>
</tr>

<tr>
<td class="left">Ethernet</td>
<td class="right">1500</td>
</tr>

<tr>
<td class="left">IEEE 802.3/802.2</td>
<td class="right">1492</td>
</tr>

<tr>
<td class="left">Point-to-Point(low delay)</td>
<td class="right">296</td>
</tr>
</tbody>
</table>
</li>
<li>IP datagramçš„å¤§å°å¦‚æœè¶…è¿‡äº†MTUçš„é™åˆ¶,é‚£ä¹ˆå°±è¦è¿›è¡Œåˆ†ç‰‡(fragmentation)æ“ä½œ.
</li>
<li>MTUçš„å¤§å°è®¾è®¡é€šå¸¸æ˜¯ä¸ºäº†æƒè¡¡1é€šä¿¡æ•ˆç‡å’Œ2ä¼ è¾“å»¶è¿Ÿè€Œé€‰å–çš„å€¼.
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-9" class="outline-3">
<h3 id="sec-2-9">Path MTU</h3>
<div class="outline-text-3" id="text-2-9">
<ul class="org-ul">
<li>å¦‚æœä¸¤å°æœºå™¨åœ¨åŒä¸€ä¸ªç½‘ç»œä¸­é€šä¿¡,é‚£ä¹ˆMTUæ¯”è¾ƒé‡è¦.å¦‚æœä¸¤ä¸ªæœºå™¨çš„é€šä¿¡è¦é€šè¿‡å¤šä¸ª
ä¸åŒçš„ç½‘ç»œ,é‚£ä¹ˆé‡è¦çš„å°±æ˜¯è¿™å¤šä¸ªç½‘ç»œMTUé‡Œé¢æœ€å°çš„é‚£ä¸ªMTU.
</li>
<li>ç”±äºAåˆ°Bçš„è·¯ç”±å’ŒBåˆ°Açš„è·¯ç”±å¯èƒ½ä¸åŒ,æ‰€ä»¥ä¸¤ä¸ªæ–¹å‘ä¸Šçš„MTUä¹Ÿä¸ä¸€å®šä¸€æ ·.
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Chapter 03: IP: Internet Protocol</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">Introduction</h3>
<div class="outline-text-3" id="text-3-1">
<ul class="org-ul">
<li>IPæ˜¯TCP/IPåè®®ç°‡é‡Œé¢æœ€é‡è¦çš„åè®®,TCP,UDP,ICMP,IGMPéƒ½æ˜¯åŒ…è£¹æˆIP datagramç„¶å
åœ¨ç½‘ç»œä¸Šä¼ è¾“çš„.
</li>
<li>ä½†æ˜¯IPåè®®å´æ˜¯ä¸€ä¸ªunreliableçš„åè®®: å®ƒä¼šå°½è‡ªå·±æœ€å¤§åŠªåŠ›å»ä¼ è¾“. å¦‚æœé‡åˆ°å®åœ¨
æ˜¯ä¼ è¾“ä¸è¿‡å»çš„æƒ…å†µ(æ¯”å¦‚ä¸­é—´çš„è·¯ç”±åäº†),é‚£ä¹ˆå®ƒçš„å¤„ç†æ–¹å¼ç®€æ´è€Œæœ‰æ•ˆ:
<ul class="org-ul">
<li>ä¸¢å¼ƒå½“å‰çš„datagram
</li>
<li>å‘é€ICMP messageç»™source
</li>
</ul>
</li>
<li>å¦‚æœä½ éœ€è¦reliableçš„åè®®,é‚£ä¹ˆéœ€è¦IPä¸Šå±‚çš„TCPåè®®æ¥ä¿è¯.
</li>
<li>æˆ‘ä»¬æŠŠIPåè®®ç§°ä½œæ˜¯connectionlessçš„,æ„æ€æ˜¯IPåè®®å¹¶ä¸ä¼šå»ä¿ç•™ä»»ä½•å…³äºåç»­å…¶ä»–
datagramæ˜¯å¦æˆåŠŸç­‰ä¿¡æ¯.å› ä¸ºæ¯ä¸ªdatagraméƒ½æ˜¯ç‹¬ç«‹ä¼ è¾“çš„(è·¯å¾„ä¹Ÿæœ‰å¯èƒ½ä¸åŒ),æ‰€ä»¥
å‘é€çš„æ—¶å€™åºåˆ—æ˜¯Aå…ˆBå,ä½†æ˜¯æœ€åæ”¶åˆ°çš„æ—¶å€™,å¯èƒ½æ˜¯Bå…ˆAå.
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">IP Header</h3>
<div class="outline-text-3" id="text-3-2">
<ul class="org-ul">
<li>ä¸‹å›¾å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„IP datagram,header, å…¶å¤§å°(åœ¨æ²¡æœ‰é€‰é¡¹å­—æ®µçš„æƒ…å†µä¸‹, ä¹Ÿå°±æ˜¯
å¤§å°æœ€å°çš„æƒ…å†µä¸‹)ä¸º20bytes
<pre class="example">
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 Unit: bit
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|version|length |   TOS         |          total length         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         identification        |flags|  fragment offset        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| time to live  | protocol      |      header checksum          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       source IP address                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    destination IP address                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                    options(multiple of 32 bits)               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</li>
<li>éœ€è¦æ³¨æ„çš„æ˜¯å·¦è¾¹çš„versionæ˜¯è¾ƒå°çš„åœ°å€,åŒæ—¶,ä¹Ÿæ”¾ç½®äº†most significant bit(å€¼
ä¸º1ä¸ä¸º0çš„è¯,è¶Šå¾€å·¦,å€¼è¶Šå¤§),æ‰€ä»¥å¯¹äºIP datagramæ¥è¯´(å…¶å®å…¶ä»–ç½‘ç»œæ•°æ®ä¹Ÿä¸€æ ·),
å®ƒä»¬éƒ½æ˜¯big-endiançš„å¸ƒå±€.
</li>
<li>ä¸ºäº†è®©å¤§å®¶å¿˜è®°big, littleç­‰"æ¨¡ç³Š"çš„åç§°,æˆ‘ä»¬æŠŠbig endianç§°ä¹‹ä¸ºnetwork order,
æ¯ä¸ªæ•°æ®åœ¨ä¼ è¾“ä¹‹å‰,ä¸€å®šè¦å…ˆè½¬æ¢æˆnetwork order.
</li>
<li>å¥½äº†,æˆ‘ä»¬ä¸‹é¢æ¥ä¸€ä¸€çœ‹çœ‹headeré‡Œé¢å„ä¸ªåŸŸçš„ä½œç”¨:
<ul class="org-ul">
<li>version:æ ‡ç¤ºIPåè®®çš„ç‰ˆæœ¬,æ™®éä½¿ç”¨çš„æ˜¯ç‰ˆæœ¬4
</li>
<li>length: å…¶å®æ˜¯header lengthçš„ç¼©å†™,å…¶ä»£è¡¨çš„æ˜¯æ•´ä¸ªheaderåœ¨å•ä½ä¸º32-bit word
æƒ…å†µä¸‹çš„é•¿åº¦.å› ä¸ºè¿™ä¸ªåŸŸä¸º4ä¸ªbit,æ‰€ä»¥header lengthæœ€é•¿ä¸º 60bytes, å¦‚æœæ²¡æœ‰
option,é‚£ä¹ˆè¿™ä¸ªåŸŸå†…å®¹å°±æ˜¯20 / (32 / 8) = 5
<pre class="example">
(2**3 + 2**2 + 2**1 + 2**0) * (32 / 8) = 60 bytes
</pre>
</li>
<li>TOS:Type of Serviceä¸º8ä¸ªbit, å…¶ä¸­:
<ul class="org-ul">
<li>3ä¸ªbitä¸ºprecedence field(å·²ç»å¼ƒç”¨)
</li>
<li>4ä¸ªbitä½TOS: åˆ†åˆ«ä¸º(åŒæ—¶åªèƒ½æœ‰å…¶ä¸­ä¸€ä¸ªbitè¢«è®¾ç½®), éƒ½ä¸è®¾ç½®ä¸ºnormal service:
<ol class="org-ol">
<li>minimize delay
</li>
<li>maximize throughput
</li>
<li>maximize reliability
</li>
<li>minimize monetary cost
</li>
</ol>
</li>
<li>1ä¸ªbitæ²¡æœ‰ä½¿ç”¨
</li>
</ul>
</li>
<li>total length:å°±æ˜¯æ•´ä¸ªip datagramçš„é•¿åº¦å•¦,å•ä½æ˜¯bytes,ç”±äºè¿™ä¸ªå­—æ®µæ˜¯16bit
é‚£ä¹ˆip datagramçš„æœ€å¤§å€¼å°±æ˜¯2**16 - 1 = 65535.ä½†æ˜¯æ²¡æœ‰äººä¼šå‘é€è¿™ä¹ˆå¤§çš„å­—æ®µ
å› ä¸ºlinkå±‚ç”±äºMTUçš„å­˜åœ¨,å¦‚æœæœ‰è¿™ä¹ˆå¤§çš„datagram, å¤§å¤šæ•°çš„linkå±‚åè®®ä¼šå¯¹å®ƒ
è¿›è¡Œåˆ†ç‰‡(fragment).ä¸ºäº†ç…§é¡¾å¤§å¤šæ•°çš„linkå±‚åè®®,ä¸€èˆ¬è§„å®šip datagramæœ€å¤§ä¸è¦
è¶…è¿‡576,è¿™ä¸æ˜¯ä¸€ä¸ªç¡¬æ€§çš„è§„å®š,ä½†æ˜¯å¤§å¤šæ•°æƒ…å†µä¸‹é€‚ç”¨.
</li>
<li>total lengthè¿™ä¸ªåŸŸå¾ˆé‡è¦,å› ä¸ºlinkå±‚çš„å¥½å¤šåè®®,æ¯”å¦‚Ethernetå¯¹å…¶fragmentå¤§å°
æœ‰ä¸ªæœ€ä½è¦æ±‚,æ˜¯46bytes.ä½†æ˜¯IP datagramå¯èƒ½ä¸åˆ°46bytes,æ‰€ä»¥linkå±‚çš„åè®®è¦
pad(å¡«å……0)åˆ°æœ€å°çš„46bytes.è¿™ä¸ªæ—¶å€™,å¿…é¡»çŸ¥é“total lengthçš„å€¼æ‰çŸ¥é“IP datagram
çš„å¤§å°
</li>
<li>identification:æ¯å‘é€ä¸€ä¸ªdatagramå°±åŠ 1, BSDçš„å®ç°æ˜¯kernelæ¥åŠ 1,ä¹Ÿå°±æ˜¯è¯´TCP
å‘é€äº†123,é‚£ä¹ˆç´§æ¥ç€å‘é€çš„UDPå°±å‘é€äº†124(è™½ç„¶UDPä¹Ÿå‘é€124ä¹Ÿæ²¡æœ‰å…³ç³»çš„)
</li>
<li>flag:ç”¨æ¥æ§åˆ¶fragment, ä¸€å…±ä¸‰ä¸ªbit:
<ol class="org-ol">
<li>bit 0: ä¿ç•™,å¿…é¡»æ˜¯é›¶
</li>
<li>bit 1: DF (Don't Forget) : è®¾ç½®äº†ä»¥å,è¿™ä¸ªdatagramå°±ä¸è¢«å…è®¸è¿›è¡Œfragment,
å¦‚æœä½ å®åœ¨è¦fragment,é‚£ä¹ˆè¿™ä¸ªdatagramå°±åªæœ‰ä¸¢å¼ƒ
</li>
<li>bit 2: MF (More Fragments) : è¢«åˆ†ç‰‡çš„å‰N-1ä¸ªfragmentéƒ½è¦è®¾ç½®è¿™ä¸ªåŸŸ,è¯´
æ˜æˆ‘ä»¬åœ¨è¢«fragment
</li>
</ol>
</li>
<li>fragment offset:
</li>
<li>TTL: time-to-live,å¯ä»¥ç»è¿‡çš„routerçš„ä¸ªæ•°(ä¸€èˆ¬ä¸º32æˆ–è€…64),æ¯ç»è¿‡ä¸€ä¸ªrouter,
å°±ä¼šå‡ä¸€,ä¸€æ—¦åˆ°é›¶,è¿™ä¸ªåŸŸå°±è¢«æŠ›å¼ƒäº†(ç„¶åä¼šå‘é€IGMPç»™sender)
</li>
<li>protocol: ç”¨æ¥æ ‡ç¤ºä¸Šä¸€å±‚çš„åè®®
</li>
<li>header checksum: ä»…ä»…ç”¨æ¥å¯¹IPå¤´éƒ¨è¿›è¡Œæ ¡éªŒ. æ¥æ”¶ç«¯checksumè®¡ç®—ç»“æœä¸ç¬¦çš„è¯,
ä¼šæŠŠdatagramç›´æ¥ä¸¢å¼ƒ(ä½†å¹¶ä¸ä¼šå‘é€ICMPç»™å‘é€æ–¹,è¿™å°±éœ€è¦ä¸Šå±‚åè®®å‘ç°å°‘äº†datagram
åè¦æ±‚å‘é€ç«¯é‡å‘)
</li>
<li>IP address: åé¢æ˜¯ä¸¤ä¸ª32-bitçš„sourceå’Œdestination IP address
</li>
<li>options: å›ºå®šheaderåé¢æ˜¯ä¸€ç³»åˆ—ä¸å¸¸ç”¨çš„options,å¤§å°æ˜¯32bitçš„æ•´æ•°å€.
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3">IP Routing</h3>
<div class="outline-text-3" id="text-3-3">
<ul class="org-ul">
<li>IP è·¯ç”±å¯»æ‰¾destination,åœ¨å¦‚ä¸‹ä¸¤ç§æƒ…å†µä¸‹æ˜¯éå¸¸ç®€å•çš„:
<ol class="org-ol">
<li>ç›®çš„åœ°å€å’Œæœ¬æœºæ˜¯é€šè¿‡PPP(point-to-point)è¿æ¥çš„
</li>
<li>ç›®çš„åœ°å€å’Œæœ¬çº§åœ¨ä¸€ä¸ªå±€åŸŸç½‘å†…(ä»¥å¤ªç½‘æˆ–è€…ä»¤ç‰Œç½‘)
</li>
</ol>
</li>
<li>å¦‚æœä¸ç¬¦åˆä»¥ä¸Šä¸¤ç§æƒ…å†µ,é‚£ä¹ˆdatagraméƒ½ä¼šå‘é€æ•°æ®åˆ°ä¸€ä¸ªæŒ‡å®šçš„è·¯ç”±å™¨,è®©è¿™ä¸ªè·¯
ç”±å™¨å»å¤„ç†å‰©ä¸‹çš„å·¥ä½œ.
</li>
<li>å…¶å®æ¯ä¸€å°è·¯ç”±å™¨åªä¸è¿‡æ˜¯é…ç½®æ¯”è¾ƒä½çš„hostè€Œå·²,æ‰€ä»¥hosté…ç½®æˆä¸€ä¸ªè·¯ç”±å™¨æ¯«æ— å‹
åŠ›,æˆ‘ä»¬ä»ç†è®ºä¸ŠåŒºåˆ†è·¯ç”±å™¨å’Œhostçš„åœ°æ–¹æ˜¯
<pre class="example">
A host never forwards datagrams from one of its interfaces
to another, while a router forwards datagrams.
</pre>
</li>
<li>æ¢å¥è¯è¯´,IPå±‚åœ¨è·¯ç”±å™¨å’Œhostä¸Šé¢éƒ½æœ‰,ä½†æ˜¯hostä¸Šé¢çš„IPå±‚ä¸åº”è¯¥å†åšè½¬å‘çš„å·¥ä½œ.
</li>
<li>æˆ‘ä»¬æ¥çœ‹çœ‹IPå±‚çš„å·¥ä½œæµç¨‹:å½“æœ¬æœº(hostæˆ–è€…router)ä»æŸä¸ªç½‘å£æ¥å—åˆ°ä¸€ä¸ªdatagram
çš„æ—¶å€™,IPå±‚é¦–å…ˆæ¥æ£€æŸ¥ç›®çš„åœ°å€çš„IPæ˜¯ä¸æ˜¯æœ¬æœºçš„"IPåœ°å€ä¹‹ä¸€",æˆ–è€…æ˜¯æœ¬æœºçš„å¹¿æ’­åœ°
å€"ä¹‹ä¸€":
<ul class="org-ul">
<li>å¦‚æœæ˜¯çš„è¯,è¿™ä¸ªIP datagramå°±ä¼šäº¤ç”±å…¶headeré‡Œé¢çš„protocolæŒ‡å®šçš„åè®®(æ¯”å¦‚TCP
æˆ–è€…UDP)æ¨¡å—å»å¤„ç†
</li>
<li>å¦‚æœä¸æ˜¯çš„è¯:
<ol class="org-ol">
<li>å¦‚æœIPå±‚æ‰€åœ¨çš„æœºå™¨æ˜¯é…ç½®æˆè·¯ç”±åŠŸèƒ½çš„(router),é‚£ä¹ˆå°±"é€šè¿‡è·¯ç”±è¡¨"è½¬å‘è¿™
ä¸ªdatagram
</li>
<li>å¦‚æœIPå±‚æ‰€åœ¨æ˜¯æœºå™¨æ˜¯é…ç½®æˆhoståŠŸèƒ½çš„,é‚£ä¹ˆå°±ç›´æ¥ä¸¢å¼ƒè¿™ä¸ªdatagram
</li>
</ol>
</li>
</ul>
</li>
<li>ä¸Šé¢è¯´äº†,å¦‚æœIPå±‚æ‰€åœ¨æœºå™¨æ˜¯é…ç½®æˆè·¯ç”±å™¨åŠŸèƒ½çš„è¯,å®ƒéœ€è¦çŸ¥é“è¿™ä¸ªdatagramè¦"è½¬
å‘"åˆ°å“ªé‡Œå»,ä¾é çš„æ˜¯è·¯ç”±è¡¨.è·¯ç”±è¡¨æœ‰ä¸‹é¢å‡ ä¸ªå­—æ®µ:
<ul class="org-ul">
<li>Destination IP address: IPå±‚å¯»æ‰¾å¤„ç†datagramçš„æ–¹æ³•ç¬¬ä¸€ä¸ªå…³å¿ƒçš„é—®é¢˜è‚¯å®šæ˜¯
"å¦‚ä½•å¯¹ä»˜æŸä¸ªIP", è¿™ä¸ª"æŸä¸ªIP"å°±æ˜¯è¿™é‡Œæ ‡ç¤ºçš„.è¡¨ç¤º"æŸä¸ªIP"æœ‰ä¸¤ç§æ–¹æ³•:
<ol class="org-ol">
<li>å®Œæ•´çš„IPåœ°å€. network address + host address,èƒ½å¤Ÿ"ç²¾ç¡®"åŒ¹é…ä¸€ä¸ª"æŸIP"
</li>
<li>åªæœ‰network address, host addressåˆ™å…¨æ˜¯0. æ¯”å¦‚192.168.188.0(è¿™ç§åœ°å€å«
åš"é»˜è®¤è·¯ç”±",ä»£è¡¨è¿™ä¸ªä¸€ä¸ªnetwork addresså…¨ä½“æˆå‘˜,æ‰€ä»¥ä¸èƒ½åˆ†é…ç»™æŸä¸ªhost)
</li>
</ol>
</li>
<li>IP address of a next-hop router: IPå±‚å¯»æ‰¾å¤„ç†datagramçš„æ–¹æ³•å†åŒ¹é…åˆ°"æŸIP"
ä»¥å,è‚¯å®šæ˜¯æƒ³çŸ¥é“å¯¹äº"æŸIP"çš„datagram,æˆ‘è¦"forward"åˆ°å“ªé‡Œ?è¿™ä¸ªforwardåˆ°çš„
åœ°æ–¹è‚¯å®šå’Œæœ¬ç½‘ç»œç›¸äº’connect."è€Œä¸”"è¿™ä¸ªç½‘ç»œå¯ä»¥å¼•å¯¼æˆ‘ä»¬èµ°å‘æœ€ç»ˆçš„ç›®çš„åœ°å€.
ä½†æ˜¯è¿™ä¸ªforwardåˆ°çš„åœ°æ–¹ä¹Ÿæœ‰ä¸¤ç§æƒ…å†µ:
<ol class="org-ol">
<li>forwardåˆ°å¦å¤–ä¸€ä¸ªrouter
</li>
<li>forwardåˆ°ä¸€ä¸ªhost (PPPåè®®é€šå¸¸ä¼šç›´æ¥forwardåˆ°æŸä¸ªä¸»æœº)
</li>
</ol>
</li>
<li>Flags: æˆ‘ä»¬å‰é¢è¯´è¿‡ä¸¤æ¬¡ä¸åŒçš„æƒ…å†µ, éƒ½éœ€è¦è¿™é‡Œçš„flagæ¥æ ‡ç¤º:
<ol class="org-ol">
<li>ä¸€ä¸ªæ˜¯åœ¨destination ip addressé¡¹é‡Œé¢å†™çš„æ˜¯å®Œæ•´hoståœ°å€,è¿˜æ˜¯æŸä¸ªnetwork
åœ°å€.
</li>
<li>ä¸€ä¸ªæ˜¯åœ¨next-hop routeré¡¹é‡Œé¢,forwardåˆ°äº†å¦å¤–ä¸€ä¸ªrouterè¿˜æ˜¯å¦å¤–ä¸€ä¸ªhost
</li>
</ol>
</li>
<li>network interface: routerä¸€èˆ¬æœ‰å¾ˆå¤šç½‘å£,è¿™æ¬¡çš„è½¬å‘è¦ä»å“ªä¸ªç½‘å£èµ°éœ€è¦ä»è¿™é‡Œ
æŒ‡å®š
</li>
</ul>
</li>
<li>åœ¨äº†è§£äº†è·¯ç”±è¡¨ä»¥å,æˆ‘ä»¬æ¥çœ‹çœ‹IPè·¯ç”±çš„è¿‡ç¨‹:
<ol class="org-ol">
<li>é¦–å…ˆå½“ç„¶æ˜¯æŸ¥è¯¢è·¯ç”±è¡¨,å¸Œæœ›ç›®çš„IPèƒ½å¤Ÿå®Œå…¨å¯¹åº”çš„,æ¯”å¦‚è·¯ç”±è¡¨é‡Œé¢åœ°å€æ˜¯192.168
.188.123,æˆ‘ä»¬datagramç›®çš„IPä¹Ÿæ˜¯è¿™ä¸ªåœ°å€,é‚£ä¹ˆ:
<ul class="org-ul">
<li>å¦‚æœnext-hopæ˜¯ä¸€ä¸ªrouter,å°±å‘é€åˆ°è¿™ä¸ªrouter
</li>
<li>å¦‚æœnext-hopæ˜¯ä¸€ä¸ªipåœ°å€,è¿™ç§æƒ…å†µå‘ç”Ÿåœ¨PPPåè®®è¿æ¥çš„æƒ…å†µä¸‹,è·¯ç”±è¡¨çš„ä¸‹
ä¸€æ­¥æ˜¯ä¸€ä¸ªIPåœ°å€
</li>
</ul>
</li>
<li>å¦‚æœæ²¡æœ‰å®Œå…¨å¯¹åº”,é‚£ä¹ˆæˆ‘ä»¬å°±å¯»æ‰¾æŠŠæˆ‘ä»¬datagram ipåœ°å€çš„ç½‘ç»œåœ°å€å–å‡ºæ¥,ç„¶å
å»è·¯ç”±è¡¨é‡Œé¢,å¯»æ‰¾ç½‘ç»œåœ°å€ç›¸åŒçš„item.å¯¹äº192.168.188.123æ¥è¯´,å°±æ˜¯å»å¯»æ‰¾è·¯
ç”±è¡¨ä¸­192.168.188.0è¿™ä¸ªnetwork adddress.å¦‚æœæ‰¾åˆ°ä¹Ÿæ˜¯:
<ul class="org-ul">
<li>å¦‚æœnext-hopæ˜¯ä¸€ä¸ªrouter,å°±å‘é€åˆ°è¿™ä¸ªrouter
</li>
<li>å¦‚æœnext-hopæ˜¯ä¸€ä¸ªipåœ°å€,è¿™ç§æƒ…å†µå‘ç”Ÿåœ¨PPPåè®®è¿æ¥çš„æƒ…å†µä¸‹,è·¯ç”±è¡¨çš„ä¸‹
ä¸€æ­¥æ˜¯ä¸€ä¸ªIPåœ°å€
</li>
</ul>
</li>
<li>å‰ä¸¤é¡¹éƒ½å¤±è´¥çš„æƒ…å†µä¸‹,é€šå¸¸éƒ½ä¼šæœ‰ä¸ªå«defaultçš„item, æŠŠdatagramå‘é€åˆ°datagram
æŒ‡å¼•ä¸‹çš„next-hop router(è¿™æ¬¡è‚¯å®šæ˜¯router,è€Œä¸å¯èƒ½æ˜¯ä¸»æœº)
</li>
</ol>
</li>
<li>å¦‚æœä¸Šé¢çš„ä¸‰ä¸ªæ­¥éª¤éƒ½å¤±è´¥çš„è¯,é‚£ä¹ˆè¿™ä¸ªdatagramå°±æ˜¯undeliverableçš„,è¿™ç§æƒ…å†µä¸‹
å°±è¦å‘é€"host unreachable"æˆ–è€…"network unreachable"é”™è¯¯åˆ°source IP.
</li>
<li>é»˜è®¤è·¯ç”±:ä¹Ÿå°±æ˜¯ä¸»æœºåœ°å€éƒ½ä¸º0çš„åœ°å€(æ¯”å¦‚192.168.188.0)ä»£è¡¨äº†è¿™ä¸ªç½‘ç»œä¸Šçš„æ‰€æœ‰
çš„ä¸»æœº,åªç”¨äº†ç¬¬ä¸€ä¸ªipåœ°å€.è¿™æå¤§çš„å‡å°äº†è·¯ç”±è¡¨çš„è§„æ¨¡
</li>
</ul>
</div>
<div id="outline-container-sec-3-3-1" class="outline-4">
<h4 id="sec-3-3-1">Example</h4>
<div class="outline-text-4" id="text-3-3-1">
<ul class="org-ul">
<li>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹é¢çš„ä¾‹å­
<pre class="example">
destination     +---------+                                                              +---------+
network         | bsdi    |                                                              |  sun    |
140.252.13.0    |         |                                                              |         |
                +----+----+                                                              +---------+
               .13.35|                                                                   .13.33 ^
                     |                                                                          |
                     |                                                                          |
          -----------+--------------------------------------------------------------------------+-----
                     |            Ethernet, 140.252.13                                          |
                     |                                                                          |
                     |                                                                          |
                     |   +--------------------------+---------------------+------------+        |
                     +--&gt;| link header              | IP header           |            +--------+
                         | Enet of 140.252.13.33    | 140.25.13.33        |            |
                         +--------------------------+---------------------+------------+
</pre>
</li>
<li>ä¸»æœºbsdiæœ‰ä¸€ä¸ªip datagramå‘é€ç»™ä¸»æœºsun,å…¶è¿‡ç¨‹å¦‚ä¸‹:
<ul class="org-ul">
<li>bsdiçš„ipå±‚ä»æŸä¸ªä¸Šå±‚æ”¶åˆ°datagramä»¥å,æœç´¢è·¯ç”±è¡¨å‘ç°ç›®çš„IPåœ°å€(140.252.13.33)
åœ¨ä¸€ä¸ªç›´æ¥ç›¸è¿çš„å±€åŸŸç½‘(ä»¥å¤ªç½‘)ä¸Š.è¿™ç§æƒ…å†µä¸‹,å¯ä»¥ç›´æ¥é€šè¿‡mac(ç‰©ç†åœ°å€è¿›è¡Œä¼ é€’)
</li>
<li>datagramè¢«ä¼ é€åˆ°ä»¥å¤ªç½‘é©±åŠ¨ç¨‹åº,ç„¶ååšä¸ºä¸€ä¸ªä»¥å¤ªç½‘frame:
<ul class="org-ul">
<li>IP headerçš„ç›®çš„åœ°å€è¿˜æ˜¯140.25.133.33
</li>
<li>Ethernet headeré‡Œé¢çš„macåœ°å€æ˜¯é€šè¿‡ARPåè®®å¾—åˆ°çš„å¯¹æ–¹ç½‘å¡çš„åœ°å€
</li>
</ul>
</li>
</ul>
</li>
<li>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­,å¤æ‚çš„ä¾‹å­ä¸­Ethernet headeré‡Œé¢çš„macåœ°å€æ˜¯next-hopçš„mac
åœ°å€,ä½†æ˜¯IP headeré‡Œé¢çš„ç›®çš„åœ°å€æ°¸è¿œéƒ½ä¸ä¼šå˜.
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-3-4" class="outline-3">
<h3 id="sec-3-4">Subnet Addressin</h3>
<div class="outline-text-3" id="text-3-4">
<ul class="org-ul">
<li>subnetæ˜¯å¯¹åŸæœ‰IPåœ°å€åˆ†ç±»çš„ä¸€ç§è¡¥å……:å› ä¸ºAç±»å’ŒBç±»åœ°å€é‡Œé¢çš„host IDå¤ªå¤šäº†(åˆ†åˆ«
æ˜¯2**24-2å’Œ2**16-2, å…¨0çš„çš„ä¸ºé»˜è®¤è·¯ç”±,å…¨1çš„ä¸ºboardcaståœ°å€),ç”¨æˆ·ä¸ä¼šåœ¨ä¸€ä¸ª
å±€åŸŸç½‘é‡Œé¢è¿æ¥è¿™ä¹ˆå¤šçš„host.
</li>
<li>é‚£ä¹ˆsubnetçš„åŸç†ä¹Ÿå°±å¾ˆç®€å•äº†:åœ¨host IDé‡Œé¢åˆ’å‡ºä¸€éƒ¨åˆ†ä½œä¸ºnetwork ID
</li>
<li>é€šå¸¸éƒ½æ˜¯local adminæ¥å†³å®šä»host IDä¸­åˆ’å‡ºå¤šå°‘ä½œä¸ºsubnet ID,å› ä¸ºBç±»åœ°å€æ¯”è¾ƒå¸¸
è§,æˆ‘ä»¬ä»¥Bç±»åœ°å€ä¸ºä¾‹:é€šå¸¸æ˜¯åˆ’å‡º8ä¸ªbitä½œä¸ºsubnetID.è¯´é€šå¸¸æ˜¯å› ä¸ºè¿™ä¸æ˜¯ä¸€å®šçš„.
åªæ˜¯8ä¸ªbitä½œä¸ºsubnetIDçš„è¯,è¯»å†™èµ·æ¥æ¯”è¾ƒå®¹æ˜“(å’ŒCç±»åœ°å€å°±å¾ˆåƒäº†)
<pre class="example">
                 14 bits                  8 bit
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
B    |1|0|        netId              |  subnetId     |     hostId    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</li>
<li>å­ç½‘è¿™ç§è®¾ç½®,å¯¹äºå¤–éƒ¨è·¯ç”±å™¨æ¥è¯´,æ˜¯transparent(æ— æ³•å¯Ÿè§‰åˆ°çš„),æ¯”å¦‚ä¸€ä¸ªBç±»åœ°å€
140.252:
<ul class="org-ul">
<li>å¯¹äºæ‰€æœ‰åœ¨è¿™ä¸ªBç±»åœ°å€ä¹‹å¤–çš„è·¯ç”±,éƒ½åªæ˜¯æŠŠå®ƒå½“åšä¸€ä¸ªæ™®é€šçš„Bç±»åœ°å€è€Œå·²
</li>
<li>å¯¹äºæ‰€æœ‰åœ¨è¿™ä¸ªBç±»åœ°å€ä¹‹å†…çš„è·¯ç”±,å°±è¦äº†è§£å®ƒæ˜¯å¦‚ä½•åˆ†é…å­ç½‘çš„äº†.ä¸ç„¶æ— æ³•å‘é€
datagramåˆ°æ­£ç¡®çš„ä½ç½®.
</li>
</ul>
</li>
<li>ç›¸æ¯”äº30ä¸ªCç±»åœ°å€,ç”¨ä¸€ä¸ªåŒ…å«30ä¸ªCç±»åœ°å€çš„Bç±»åœ°å€çš„å¥½å¤„,æ˜¯å¯ä»¥æå¤§çš„ç¼©å°Internet
è·¯ç”±è¡¨çš„è§„æ¨¡.
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">

         <!-- Disqus Comment BEGIN -->
          <div id="disqus_thread"></div>
          <script type="text/javascript">
              var disqus_shortname = 'harrifeng';

              (function() {
                  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
              })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

         <!-- Disqus Comment END -->
</div>
</body>
</html>
